{
  "hash": "aacb6cd4fffce58fe2853da613b06599",
  "result": {
    "markdown": "# About {.unnumbered}\n\nThe field of thermoregulation is fundamental to photosynthesis but the lack of understanding and process-based modelling of leaf temperature regulation creates a knowledge gap worthy of investigation. Moreover, by exploiting EEO principles, we can create a model that accounts for the interplay of thermal acclimation and thermoregulation. Understanding this interplay is an unresolved but highly relevant question because it gives insights into the processes a plant may use to cope with a rising temperatures [@cavaleri2020cold].\n\nThis tutorial provides the scientific basis and code implementation to model a leaf's temperature based on thermodynamic theory and eco-evolutionary optimality theory. @sec-motivation gives insight into the current debate on leaf thermoregulation and makes the statement how eco-evolutionary optimality theory may provide a solution to this issue. In @sec-algorithm, a numerical algorithm is presented alongside a sensitivity analysis showing the strengths and weaknesses of the current implemenation. In @sec-next-steps, further improvements of the algorithm and ideas for potential test-cases to evaluate the model are provided.\n\n# Requirements\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nsource(here::here(\"R/_setup.R\"))\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nsessionInfo()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nR version 4.3.1 (2023-06-16)\nPlatform: aarch64-apple-darwin20 (64-bit)\nRunning under: macOS Ventura 13.4.1\n\nMatrix products: default\nBLAS:   /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/lib/libRblas.0.dylib \nLAPACK: /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.11.0\n\nlocale:\n[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8\n\ntime zone: Europe/Zurich\ntzcode source: internal\n\nattached base packages:\n[1] stats     graphics  grDevices datasets  utils     methods   base     \n\nother attached packages:\n [1] conflicted_1.2.0 quarto_1.2       rpmodel_1.2.0    patchwork_1.1.3 \n [5] lubridate_1.9.2  forcats_1.0.0    stringr_1.5.0    dplyr_1.1.2     \n [9] purrr_1.0.2      readr_2.1.4      tidyr_1.3.0      tibble_3.2.1    \n[13] ggplot2_3.4.3    tidyverse_2.0.0  here_1.0.1      \n\nloaded via a namespace (and not attached):\n [1] utf8_1.2.3        generics_0.1.3    renv_0.17.3       stringi_1.7.12   \n [5] hms_1.1.3         digest_0.6.33     magrittr_2.0.3    evaluate_0.21    \n [9] grid_4.3.1        timechange_0.2.0  fastmap_1.1.1     rprojroot_2.0.3  \n[13] jsonlite_1.8.7    processx_3.8.2    ps_1.7.5          fansi_1.0.4      \n[17] scales_1.2.1      cli_3.6.1         rlang_1.1.1       munsell_0.5.0    \n[21] cachem_1.0.8      withr_2.5.0       yaml_2.3.7        tools_4.3.1      \n[25] tzdb_0.4.0        memoise_2.0.1     colorspace_2.1-0  vctrs_0.6.3      \n[29] R6_2.5.1          lifecycle_1.0.3   pkgconfig_2.0.3   pillar_1.9.0     \n[33] later_1.3.1       gtable_0.3.3      glue_1.6.2        Rcpp_1.0.11      \n[37] xfun_0.40         tidyselect_1.2.0  rstudioapi_0.15.0 knitr_1.43       \n[41] htmltools_0.5.6   rmarkdown_2.24    compiler_4.3.1   \n```\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nrenv::diagnostics()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nDiagnostics Report [renv 0.17.3]\n================================\n\n# Session Info =======================\nR version 4.3.1 (2023-06-16)\nPlatform: aarch64-apple-darwin20 (64-bit)\nRunning under: macOS Ventura 13.4.1\n\nMatrix products: default\nBLAS:   /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/lib/libRblas.0.dylib \nLAPACK: /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.11.0\n\nlocale:\n[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8\n\ntime zone: Europe/Zurich\ntzcode source: internal\n\nattached base packages:\n[1] stats     graphics  grDevices datasets  utils     methods   base     \n\nother attached packages:\n [1] conflicted_1.2.0 quarto_1.2       rpmodel_1.2.0    patchwork_1.1.3 \n [5] lubridate_1.9.2  forcats_1.0.0    stringr_1.5.0    dplyr_1.1.2     \n [9] purrr_1.0.2      readr_2.1.4      tidyr_1.3.0      tibble_3.2.1    \n[13] ggplot2_3.4.3    tidyverse_2.0.0  here_1.0.1      \n\nloaded via a namespace (and not attached):\n [1] utf8_1.2.3        generics_0.1.3    renv_0.17.3       stringi_1.7.12   \n [5] hms_1.1.3         digest_0.6.33     magrittr_2.0.3    evaluate_0.21    \n [9] grid_4.3.1        timechange_0.2.0  fastmap_1.1.1     rprojroot_2.0.3  \n[13] jsonlite_1.8.7    processx_3.8.2    ps_1.7.5          fansi_1.0.4      \n[17] scales_1.2.1      cli_3.6.1         rlang_1.1.1       munsell_0.5.0    \n[21] cachem_1.0.8      withr_2.5.0       yaml_2.3.7        tools_4.3.1      \n[25] tzdb_0.4.0        memoise_2.0.1     colorspace_2.1-0  vctrs_0.6.3      \n[29] R6_2.5.1          lifecycle_1.0.3   pkgconfig_2.0.3   pillar_1.9.0     \n[33] later_1.3.1       gtable_0.3.3      glue_1.6.2        Rcpp_1.0.11      \n[37] xfun_0.40         tidyselect_1.2.0  rstudioapi_0.15.0 knitr_1.43       \n[41] htmltools_0.5.6   rmarkdown_2.24    compiler_4.3.1   \n\n# Project ============================\nProject path: \"~/repos/padasch/leaf_energy_balance_tutorial\"\n\n# Status =============================\n* The project is already synchronized with the lockfile.\n\n# Packages ===========================\n                  Library Source    Lockfile Source Path Dependency\nDBI                 1.1.3   CRAN        <NA>   <NA>  [1]       <NA>\nKernSmooth        2.23-21   CRAN        <NA>   <NA>  [2]       <NA>\nMASS               7.3-60   CRAN        <NA>   <NA>  [2]       <NA>\nMatrix            1.5-4.1   CRAN        <NA>   <NA>  [2]       <NA>\nR6                  2.5.1   CRAN       2.5.1   CRAN  [1]   indirect\nRColorBrewer        1.1-3   CRAN        <NA>   <NA>  [1]       <NA>\nRcgmin          2022-4.30   CRAN   2022-4.30   CRAN  [1]   indirect\nRcpp               1.0.11   CRAN        <NA>   <NA>  [1]       <NA>\nRvmmin        2018-4.17.1   CRAN 2018-4.17.1   CRAN  [1]   indirect\naskpass               1.1   CRAN        <NA>   <NA>  [1]       <NA>\nbackports           1.4.1   CRAN        <NA>   <NA>  [1]       <NA>\nbase64enc           0.1-3   CRAN       0.1-3   CRAN  [1]   indirect\nbit                 4.0.5   CRAN        <NA>   <NA>  [1]       <NA>\nbit64               4.0.5   CRAN        <NA>   <NA>  [1]       <NA>\nblob                1.2.4   CRAN        <NA>   <NA>  [1]       <NA>\nboot             1.3-28.1   CRAN        <NA>   <NA>  [2]       <NA>\nbroom               1.0.5   CRAN        <NA>   <NA>  [1]       <NA>\nbslib               0.5.1   CRAN       0.5.1   CRAN  [1]   indirect\ncachem              1.0.8   CRAN       1.0.8   CRAN  [1]   indirect\ncallr               3.7.3   CRAN        <NA>   <NA>  [1]       <NA>\ncellranger          1.1.0   CRAN        <NA>   <NA>  [1]       <NA>\nclass              7.3-22   CRAN        <NA>   <NA>  [2]       <NA>\ncli                 3.6.1   CRAN       3.6.1   CRAN  [1]   indirect\nclipr               0.8.0   CRAN        <NA>   <NA>  [1]       <NA>\ncluster             2.1.4   CRAN        <NA>   <NA>  [2]       <NA>\ncodetools          0.2-19   CRAN        <NA>   <NA>  [2]       <NA>\ncolorspace          2.1-0   CRAN        <NA>   <NA>  [1]       <NA>\ncommonmark          1.9.0   CRAN        <NA>   <NA>  [1]       <NA>\nconflicted          1.2.0   CRAN        <NA>   <NA>  [1]       <NA>\ncpp11               0.4.6   CRAN        <NA>   <NA>  [1]       <NA>\ncrayon              1.5.2   CRAN        <NA>   <NA>  [1]       <NA>\ncurl                5.0.2   CRAN        <NA>   <NA>  [1]       <NA>\ndata.table         1.14.8   CRAN        <NA>   <NA>  [1]       <NA>\ndbplyr              2.3.3   CRAN        <NA>   <NA>  [1]       <NA>\ndigest             0.6.33   CRAN      0.6.33   CRAN  [1]   indirect\ndplyr               1.1.2   CRAN        <NA>   <NA>  [1]       <NA>\ndtplyr              1.3.1   CRAN        <NA>   <NA>  [1]       <NA>\nellipsis            0.3.2   CRAN       0.3.2   CRAN  [1]   indirect\nevaluate             0.21   CRAN        0.21   CRAN  [1]   indirect\nfansi               1.0.4   CRAN        <NA>   <NA>  [1]       <NA>\nfarver              2.1.1   CRAN        <NA>   <NA>  [1]       <NA>\nfastmap             1.1.1   CRAN       1.1.1   CRAN  [1]   indirect\nfontawesome         0.5.1   CRAN       0.5.1   CRAN  [1]   indirect\nforcats             1.0.0   CRAN        <NA>   <NA>  [1]       <NA>\nforeign            0.8-84   CRAN        <NA>   <NA>  [2]       <NA>\nfs                  1.6.3   CRAN       1.6.3   CRAN  [1]   indirect\ngargle              1.5.2   CRAN        <NA>   <NA>  [1]       <NA>\ngenerics            0.1.3   CRAN        <NA>   <NA>  [1]       <NA>\nggplot2             3.4.3   CRAN        <NA>   <NA>  [1]       <NA>\nglue                1.6.2   CRAN       1.6.2   CRAN  [1]   indirect\ngoogledrive         2.1.1   CRAN        <NA>   <NA>  [1]       <NA>\ngooglesheets4       1.1.1   CRAN        <NA>   <NA>  [1]       <NA>\ngrDevices            <NA>   <NA>        <NA>   <NA>  [2]   indirect\ngraphics             <NA>   <NA>        <NA>   <NA>  [2]   indirect\ngtable              0.3.3   CRAN        <NA>   <NA>  [1]       <NA>\nhaven               2.5.3   CRAN        <NA>   <NA>  [1]       <NA>\nhere                1.0.1   CRAN       1.0.1   CRAN  [1]     direct\nhighr                0.10   CRAN        0.10   CRAN  [1]   indirect\nhms                 1.1.3   CRAN        <NA>   <NA>  [1]       <NA>\nhtmltools           0.5.6   CRAN       0.5.6   CRAN  [1]   indirect\nhttr                1.4.7   CRAN        <NA>   <NA>  [1]       <NA>\nids                 1.0.1   CRAN        <NA>   <NA>  [1]       <NA>\nisoband             0.2.7   CRAN        <NA>   <NA>  [1]       <NA>\njquerylib           0.1.4   CRAN       0.1.4   CRAN  [1]   indirect\njsonlite            1.8.7   CRAN       1.8.7   CRAN  [1]   indirect\nknitr                1.43   CRAN        1.43   CRAN  [1]     direct\nlabeling            0.4.2   CRAN        <NA>   <NA>  [1]       <NA>\nlater               1.3.1   CRAN        <NA>   <NA>  [1]       <NA>\nlattice            0.21-8   CRAN        <NA>   <NA>  [2]       <NA>\nlifecycle           1.0.3   CRAN       1.0.3   CRAN  [1]   indirect\nlubridate           1.9.2   CRAN        <NA>   <NA>  [1]       <NA>\nmagrittr            2.0.3   CRAN       2.0.3   CRAN  [1]   indirect\nmarkdown              1.7   CRAN        <NA>   <NA>  [1]       <NA>\nmemoise             2.0.1   CRAN       2.0.1   CRAN  [1]   indirect\nmethods              <NA>   <NA>        <NA>   <NA>  [2]   indirect\nmgcv               1.8-42   CRAN        <NA>   <NA>  [2]       <NA>\nmime                 0.12   CRAN        0.12   CRAN  [1]   indirect\nmodelr             0.1.11   CRAN        <NA>   <NA>  [1]       <NA>\nmunsell             0.5.0   CRAN        <NA>   <NA>  [1]       <NA>\nnlme              3.1-162   CRAN        <NA>   <NA>  [2]       <NA>\nnnet               7.3-19   CRAN        <NA>   <NA>  [2]       <NA>\nnumDeriv       2016.8-1.1   CRAN  2016.8-1.1   CRAN  [1]   indirect\nopenssl             2.1.0   CRAN        <NA>   <NA>  [1]       <NA>\noptextras       2019-12.4   CRAN   2019-12.4   CRAN  [1]   indirect\noptimr         2019-12.16   CRAN  2019-12.16   CRAN  [1]     direct\npackrat             0.9.1   CRAN        <NA>   <NA>  [1]       <NA>\npatchwork           1.1.3   CRAN        <NA>   <NA>  [1]       <NA>\npillar              1.9.0   CRAN        <NA>   <NA>  [1]       <NA>\npkgconfig           2.0.3   CRAN        <NA>   <NA>  [1]       <NA>\nprettyunits         1.1.1   CRAN        <NA>   <NA>  [1]       <NA>\nprocessx            3.8.2   CRAN        <NA>   <NA>  [1]       <NA>\nprogress            1.2.2   CRAN        <NA>   <NA>  [1]       <NA>\nps                  1.7.5   CRAN        <NA>   <NA>  [1]       <NA>\npurrr               1.0.2   CRAN        <NA>   <NA>  [1]       <NA>\nquarto                1.2   CRAN        <NA>   <NA>  [1]       <NA>\nragg                1.2.5   CRAN        <NA>   <NA>  [1]       <NA>\nrappdirs            0.3.3   CRAN       0.3.3   CRAN  [1]   indirect\nreadr               2.1.4   CRAN        <NA>   <NA>  [1]       <NA>\nreadxl              1.4.3   CRAN        <NA>   <NA>  [1]       <NA>\nrematch             1.0.1   CRAN        <NA>   <NA>  [1]       <NA>\nrematch2            2.1.2   CRAN        <NA>   <NA>  [1]       <NA>\nrenv               0.17.3   CRAN      0.17.3   CRAN  [1]     direct\nreprex              2.0.2   CRAN        <NA>   <NA>  [1]       <NA>\nrlang               1.1.1   CRAN       1.1.1   CRAN  [1]   indirect\nrmarkdown            2.24   CRAN        2.24   CRAN  [1]     direct\nrpart              4.1.19   CRAN        <NA>   <NA>  [2]       <NA>\nrpmodel             1.2.0   CRAN       1.2.0   CRAN  [1]     direct\nrprojroot           2.0.3   CRAN       2.0.3   CRAN  [1]   indirect\nrsconnect           1.0.1   CRAN        <NA>   <NA>  [1]       <NA>\nrstudioapi         0.15.0   CRAN        <NA>   <NA>  [1]       <NA>\nrvest               1.0.3   CRAN        <NA>   <NA>  [1]       <NA>\nsass                0.4.7   CRAN       0.4.7   CRAN  [1]   indirect\nscales              1.2.1   CRAN        <NA>   <NA>  [1]       <NA>\nselectr             0.4-2   CRAN        <NA>   <NA>  [1]       <NA>\nsetRNG           2022.4-1   CRAN    2022.4-1   CRAN  [1]   indirect\nspatial            7.3-16   CRAN        <NA>   <NA>  [2]       <NA>\nstats                <NA>   <NA>        <NA>   <NA>  [2]   indirect\nstringi            1.7.12   CRAN      1.7.12   CRAN  [1]   indirect\nstringr             1.5.0   CRAN       1.5.0   CRAN  [1]   indirect\nsurvival            3.5-5   CRAN        <NA>   <NA>  [2]       <NA>\nsys                 3.4.2   CRAN        <NA>   <NA>  [1]       <NA>\nsystemfonts         1.0.4   CRAN        <NA>   <NA>  [1]       <NA>\ntextshaping         0.3.6   CRAN        <NA>   <NA>  [1]       <NA>\ntibble              3.2.1   CRAN        <NA>   <NA>  [1]       <NA>\ntidyr               1.3.0   CRAN        <NA>   <NA>  [1]       <NA>\ntidyselect          1.2.0   CRAN        <NA>   <NA>  [1]       <NA>\ntidyverse           2.0.0   CRAN        <NA>   <NA>  [1]       <NA>\ntimechange          0.2.0   CRAN        <NA>   <NA>  [1]       <NA>\ntinytex              0.46   CRAN        0.46   CRAN  [1]   indirect\ntools                <NA>   <NA>        <NA>   <NA>  [2]   indirect\ntzdb                0.4.0   CRAN        <NA>   <NA>  [1]       <NA>\nutf8                1.2.3   CRAN        <NA>   <NA>  [1]       <NA>\nutils                <NA>   <NA>        <NA>   <NA>  [2]   indirect\nuuid                1.1-0   CRAN        <NA>   <NA>  [1]       <NA>\nvctrs               0.6.3   CRAN       0.6.3   CRAN  [1]   indirect\nviridisLite         0.4.2   CRAN        <NA>   <NA>  [1]       <NA>\nvroom               1.6.3   CRAN        <NA>   <NA>  [1]       <NA>\nwithr               2.5.0   CRAN        <NA>   <NA>  [1]       <NA>\nxfun                 0.40   CRAN        0.40   CRAN  [1]   indirect\nxml2                1.3.5   CRAN        <NA>   <NA>  [1]       <NA>\nyaml                2.3.7   CRAN       2.3.7   CRAN  [1]   indirect\n\n[1]: /Users/pascal/repos/padasch/leaf_energy_balance_tutorial/renv/library/R-4.3/aarch64-apple-darwin20\n[2]: /Users/pascal/Library/Caches/org.R-project.R/R/renv/sandbox/R-4.3/aarch64-apple-darwin20/84ba8b13 \n\n# ABI ================================\n* No ABI conflicts were detected in the set of installed packages.\n\n# User Profile =======================\n[no user profile detected]\n\n# Settings ===========================\nList of 11\n $ bioconductor.version     : NULL\n $ external.libraries       : chr(0) \n $ ignored.packages         : chr(0) \n $ package.dependency.fields: chr [1:3] \"Imports\" \"Depends\" \"LinkingTo\"\n $ r.version                : NULL\n $ snapshot.type            : chr \"implicit\"\n $ use.cache                : logi TRUE\n $ vcs.ignore.cellar        : logi TRUE\n $ vcs.ignore.library       : logi TRUE\n $ vcs.ignore.local         : logi TRUE\n $ vcs.manage.ignores       : logi TRUE\n\n# Options ============================\nList of 9\n $ defaultPackages                     : chr [1:6] \"datasets\" \"utils\" \"grDevices\" \"graphics\" ...\n $ download.file.method                : NULL\n $ download.file.extra                 : NULL\n $ install.packages.compile.from.source: chr \"interactive\"\n $ pkgType                             : chr \"both\"\n $ repos                               : Named chr \"https://cran.rstudio.com\"\n  ..- attr(*, \"names\")= chr \"CRAN\"\n $ renv.consent                        : logi TRUE\n $ renv.project.path                   : chr \"/Users/pascal/repos/padasch/leaf_energy_balance_tutorial\"\n $ renv.verbose                        : logi TRUE\n\n# Environment Variables ==============\nHOME                        = /Users/pascal\nLANG                        = en_US.UTF-8\nMAKE                        = make\nR_LIBS                      = /Users/pascal/repos/padasch/leaf_energy_balance_tutorial/renv/library/R-4.3/aarch64-apple-darwin20:/Users/pascal/Library/Caches/org.R-project.R/R/renv/sandbox/R-4.3/aarch64-apple-darwin20/84ba8b13\nR_LIBS_SITE                 = /Library/Frameworks/R.framework/Resources/site-library\nR_LIBS_USER                 = /Users/pascal/repos/padasch/leaf_energy_balance_tutorial/renv/library/R-4.3/aarch64-apple-darwin20:/Users/pascal/Library/Caches/org.R-project.R/R/renv/sandbox/R-4.3/aarch64-apple-darwin20/84ba8b13\nRENV_DEFAULT_R_ENVIRON      = <NA>\nRENV_DEFAULT_R_ENVIRON_USER = <NA>\nRENV_DEFAULT_R_LIBS         = <NA>\nRENV_DEFAULT_R_LIBS_SITE    = /Library/Frameworks/R.framework/Resources/site-library\nRENV_DEFAULT_R_LIBS_USER    = /Users/pascal/Library/R/arm64/4.3/library\nRENV_DEFAULT_R_PROFILE      = <NA>\nRENV_DEFAULT_R_PROFILE_USER = <NA>\nRENV_PROJECT                = /Users/pascal/repos/padasch/leaf_energy_balance_tutorial\n\n# PATH ===============================\n- /Users/pascal/anaconda3/bin\n- /usr/local/bin\n- /System/Cryptexes/App/usr/bin\n- /usr/bin\n- /bin\n- /usr/sbin\n- /sbin\n- /var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/local/bin\n- /var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/bin\n- /var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/appleinternal/bin\n- /Applications/quarto/bin\n- /Library/TeX/texbin\n- /Users/pascal/Applications/quarto/bin\n- /usr/texbin\n- /Applications/RStudio.app/Contents/Resources/app/bin/postback\n\n# Cache ==============================\nThere are a total of 416 packages installed in the renv cache.\nCache path: \"~/Library/Caches/org.R-project.R/R/renv/cache/v5/R-4.3/aarch64-apple-darwin20\"\n```\n:::\n:::\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}