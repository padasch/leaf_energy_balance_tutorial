<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Leaf Energy Balance Tutorial - 2&nbsp; Theory</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./03-implementation.html" rel="next">
<link href="./01-introduction.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Leaf Energy Balance Tutorial</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/padasch/leaf_energy_balance_tutorial" rel="" target=""><i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://twitter.com/intent/tweet?url=|url|">
              <i class="bi bi-bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://www.facebook.com/sharer/sharer.php?u=|url|">
              <i class="bi bi-bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
      </ul>
    </div>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./02-theory.html"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Theory</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">About</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-theory.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Theory</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-implementation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Algorithm</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-sensitivity_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">04-sensitivity_analysis.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-test_case.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Test Cases</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./98-next-steps.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Next Steps</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./99-variables.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Variables</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#instantaneous-photosynthesis" id="toc-instantaneous-photosynthesis" class="nav-link active" data-scroll-target="#instantaneous-photosynthesis"><span class="header-section-number">2.0.1</span> Instantaneous Photosynthesis</a></li>
  <li><a href="#acclimated-photosynthesis" id="toc-acclimated-photosynthesis" class="nav-link" data-scroll-target="#acclimated-photosynthesis"><span class="header-section-number">2.0.2</span> Acclimated Photosynthesis</a></li>
  <li><a href="#drivers" id="toc-drivers" class="nav-link" data-scroll-target="#drivers"><span class="header-section-number">2.0.3</span> Drivers</a></li>
  <li><a href="#relevance-of-predicting-leaf-temperatures" id="toc-relevance-of-predicting-leaf-temperatures" class="nav-link" data-scroll-target="#relevance-of-predicting-leaf-temperatures"><span class="header-section-number">3</span> Relevance of Predicting Leaf Temperatures</a></li>
  <li><a href="#sec-leb" id="toc-sec-leb" class="nav-link" data-scroll-target="#sec-leb"><span class="header-section-number">4</span> A Leaf’s Energy Balance</a></li>
  <li><a href="#the-p-model" id="toc-the-p-model" class="nav-link" data-scroll-target="#the-p-model"><span class="header-section-number">5</span> The P-Model</a>
  <ul class="collapse">
  <li><a href="#background" id="toc-background" class="nav-link" data-scroll-target="#background"><span class="header-section-number">5.1</span> Background</a></li>
  <li><a href="#an-analytic-approach" id="toc-an-analytic-approach" class="nav-link" data-scroll-target="#an-analytic-approach"><span class="header-section-number">5.2</span> An Analytic Approach</a></li>
  <li><a href="#a-numeric-approach" id="toc-a-numeric-approach" class="nav-link" data-scroll-target="#a-numeric-approach"><span class="header-section-number">5.3</span> A Numeric Approach</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-theory" class="quarto-section-identifier"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Theory</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Visualizations and functions for the equations below are given in the Chapter Implementation</p>
</div>
</div>
<section id="instantaneous-photosynthesis" class="level3" data-number="2.0.1">
<h3 data-number="2.0.1" class="anchored" data-anchor-id="instantaneous-photosynthesis"><span class="header-section-number">2.0.1</span> Instantaneous Photosynthesis</h3>
<p>Photosynthesis is the process by which plants use the energy from sunlight to turn CO<span class="math inline">\(_2\)</span> and H<span class="math inline">\(_2\)</span>O into biomass and O<span class="math inline">\(_2\)</span>. A commonly used photosynthesis model, the Farquhar-vonCaemmerer-Berry Model <span class="citation" data-cites="berry1980photosynthetic">(<a href="references.html#ref-berry1980photosynthetic" role="doc-biblioref">Berry &amp; Bjorkman, 1980</a>)</span> describes gross photosynthesis (<span class="math inline">\(A_{gross}\)</span>) as the smaller of two reactions:</p>
<p><span class="math display">\[
A_{gross} = \text{min}(A_c,\; A_j)
\]</span></p>
<p><span class="math inline">\(A_c\)</span> is the carboxylation-limited photosynthesis rate. Carboxylation is the reaction of CO<span class="math inline">\(_2\)</span> with the enzyme key photosynthesis enzyme Rubisco. Therefore, the maximum rate of carboxylation (<span class="math inline">\(V_{cmax}\)</span>) directly controls <span class="math inline">\(A_c\)</span>. Additionally, <span class="math inline">\(A_c\)</span> is constrained depends on the amount of CO<span class="math inline">\(_2\)</span> that is available in the leaf (<span class="math inline">\(c_i\)</span>), and is constrained by additional enzyme-dynamics that we skip for now (given by the Michaelis-Menten Konstant <span class="math inline">\(K\)</span> and the photorespiration <span class="math inline">\(\Gamma^*\)</span>). <span class="math inline">\(A_c\)</span> is defined as:</p>
<p><span class="math display">\[
A_c = V_{cmax}\frac{c_i - \Gamma^*}{c_i-K}\
\]</span></p>
<p><span class="math inline">\(A_j\)</span> is the RuBP-photosynthesis rate. RuBP is another crucial enzyme in the photosynthesic cycle and its regeneration depends on the electron transport coming from harvesting the incoming light. Thus, this photosynthesis rate is also often called “electron transport-limited rate”. <span class="math inline">\(A_j\)</span> is therefore directly dependent on <span class="math inline">\(J\)</span>, the electron transport rate, as shown below:</p>
<p><span class="math display">\[
A_j = \frac{J}{4}\frac{c_i-\Gamma^*}{c_i+2\Gamma^*}
\]</span></p>
<p>The electron transport rate is further defined by a saturating function, whereby <span class="math inline">\(J\)</span> increases with the absorbed light (<span class="math inline">\(I_{abs\)</span>) up to an maximum electron transport rate <span class="math inline">\(J_{max}\)</span>:</p>
<p><span class="math display">\[
J=\frac{4 \varphi I_{abs}}{\sqrt{1+\left(\dfrac{4 \varphi I_{abs}}{J_{max}}\right)^{2}}}
\]</span></p>
<p>Here, <span class="math inline">\(\varphi\)</span> is the quantum yield efficiency of photosynthesis and describes how many moles of carbon are bound per mole of electrons. Technically, eight electrons are necessary to bind one CO<span class="math inline">\(_2\)</span>, so the quantum yield efficiency is often set to 0.125 (but may vary in reality due to abiotic and biotic conditions).</p>
<p>Key to take away from this short primer is that we require three variables: <span class="math inline">\(c_i\)</span>, <span class="math inline">\(V_{cmax}\)</span>, <span class="math inline">\(J_{max}\)</span>. It is known that these variables vary highly across plant species and ecosystems, which is why many modelers use empirical data to prescribe these values <span class="citation" data-cites="rogers2014use">(<a href="references.html#ref-rogers2014use" role="doc-biblioref">Rogers, 2014</a>)</span>. However, recent research showed that these variables are quite predictable from climatic data because plants seem to acclimate (i.e., adjust) their physiology to their growth environment in a similar matter around the globe <span class="citation" data-cites="peng2021global">(<a href="references.html#ref-peng2021global" role="doc-biblioref">Peng et al., 2021</a>)</span>.</p>
<p>Before we get to the acclimated part, we must also understand how CO<span class="math inline">\(_2\)</span> actually enters a leaf. All gaseous exchange with the atmosphere goes through small openings in a leaf, called the stomata, which are actively opened and closed by the leaf itself. As stomatas open CO<span class="math inline">\(_2\)</span> enters and H<span class="math inline">\(_2\)</span>O leaves the leaf. This is a classic diffusion, which is controlled by the diffusivity of the compound in question and the gradient in compound concentration in the leaf and in the atmosphere. Using Fick’s law, the transpiration of H<span class="math inline">\(_2\)</span>O is:</p>
<p><span class="math display">\[
E = g_s 1.6D
\]</span></p>
<p>Here, <span class="math inline">\(E\)</span> is the transpiration of water, <span class="math inline">\(D\)</span> is the vapor pressure deficit (the difference between actual and saturated water vapor pressure), <span class="math inline">\(g_s\)</span> is the stomatal conductance of CO<span class="math inline">\(_2\)</span> (the <span class="math inline">\(1.6\)</span> are to transform the H<span class="math inline">\(_2\)</span>O flux into units of CO<span class="math inline">\(_2\)</span>). This stomatal conductance can then be used in a separate stomatal conductance model that predicts how <span class="math inline">\(c_i\)</span> varies</p>
</section>
<section id="acclimated-photosynthesis" class="level3" data-number="2.0.2">
<h3 data-number="2.0.2" class="anchored" data-anchor-id="acclimated-photosynthesis"><span class="header-section-number">2.0.2</span> Acclimated Photosynthesis</h3>
<section id="the-original-p-model" class="level4" data-number="2.0.2.1">
<h4 data-number="2.0.2.1" class="anchored" data-anchor-id="the-original-p-model"><span class="header-section-number">2.0.2.1</span> The original P-Model</h4>
<p>To predict the three key variables mentioned above, we use the “P-Model” (the “P” stands for “Productivity”) formulation that was originally published by <span class="citation" data-cites="prentice2014balancing">Prentice et al. (<a href="references.html#ref-prentice2014balancing" role="doc-biblioref">2014</a>)</span>. The model is based on two eco-evolutionary optimality principles. The <strong>Coordination Hypothesis</strong> states that a leave coordinates its physiology so that during midday conditions (high light, high temperature) neither photosynthesis rate is limiting:</p>
<p><span class="math display">\[
A_{gross} = A_c = A_j
\]</span></p>
<p>The <strong>Least-Cost Hypothesis</strong> applies the economic principle of resource optimization to a plant. To maintain its product (biomass, here <span class="math inline">\(A_{gross}\)</span>), a plant needs to balance its carbon resource investments for building its “infrastructure” to bind CO<span class="math inline">\(_2\)</span> and to maintain a matching supply of H<span class="math inline">\(_2\)</span>O. In other words, there must exists an optimal ratio of internal to atmospheric CO<span class="math inline">\(_2\)</span> concentrations (<span class="math inline">\(\chi\)</span>), so that the marginal costs for maintaining electron transport and carboxylation are minimal:</p>
<p><span class="math display">\[
a \frac{\partial(E / A_{gross})}{\partial \chi}+b \frac{\partial\left(V_{cmax} / A_{gross}\right)}{\partial \chi} = 0
\]</span></p>
<p>Here, <span class="math inline">\(a\)</span> is the marginal cost to maintain a given water transport rate, <span class="math inline">\(b\)</span> is the marginal cost to maintain a given carboxylation transport rate. Accounting for the temperature dependency of water (<span class="math inline">\(\eta^*\)</span>), we can express the marginal costs as a ratio - the ratio between the marginal costs of maintaining carboxylation over maintaining water transport:</p>
<p><span class="math display">\[
\beta = b/a \,\eta^*
\]</span></p>
<p>Applying these two principles predicts <span class="math inline">\(V_{cmax}\)</span> and <span class="math inline">\(g_{s}\)</span> jointly and how they vary with climatic conditions for <span class="math inline">\(I_{abs}\)</span>, CO<span class="math inline">\(_{2}\)</span>, <span class="math inline">\(D\)</span>, air temperature (<span class="math inline">\(T\)</span>), and atmospheric pressure (<span class="math inline">\(P_{atm}\)</span>).</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>A detailed explanation and derivation of the P-Model, including accounting for the marginal costs of maintaining electron transport, is given in <span class="citation" data-cites="stocker2020pmodel">B. D. Stocker et al. (<a href="references.html#ref-stocker2020pmodel" role="doc-biblioref">2020</a>)</span> and available as code in <span class="citation" data-cites="stocker2021rpmodel">B. Stocker &amp; Hufkens (<a href="references.html#ref-stocker2021rpmodel" role="doc-biblioref">2021</a>)</span>.</p>
</div>
</div>
</section>
<section id="a-numerical-approach" class="level4" data-number="2.0.2.2">
<h4 data-number="2.0.2.2" class="anchored" data-anchor-id="a-numerical-approach"><span class="header-section-number">2.0.2.2</span> A numerical approach</h4>
</section>
</section>
<section id="drivers" class="level3" data-number="2.0.3">
<h3 data-number="2.0.3" class="anchored" data-anchor-id="drivers"><span class="header-section-number">2.0.3</span> Drivers</h3>
<!--# TODO -->
<ul>
<li>NEXT: I left off realizing that the whole instantaneous photosynthesis explanation is probably no necessary here… And I found it hard to explain what we actually need to know and what we are actually doing…</li>
</ul>
</section>
<section id="relevance-of-predicting-leaf-temperatures" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Relevance of Predicting Leaf Temperatures</h1>
<ul>
<li><p>Explain ongoing discussion on leaf temperature and thermoregulation</p></li>
<li><p>Recent publications</p>
<ul>
<li><p>Vinod2023</p></li>
<li><p>Ghuo2023</p></li>
<li><p>Michaletz paper</p></li>
<li><p>Still2020</p></li>
<li></li>
</ul></li>
</ul>
</section>
<section id="sec-leb" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> A Leaf’s Energy Balance</h1>
<ul>
<li><p>A leaf’s energy balance is governed by incoming and outgoing radiation.</p></li>
<li><p>Add Figure</p></li>
<li><p>Add some equations to make it fancy</p></li>
</ul>
</section>
<section id="the-p-model" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> The P-Model</h1>
<section id="background" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="background"><span class="header-section-number">5.1</span> Background</h2>
<p>The P-Model - the “P” stands for “Productivity) - is a photosynthesis model that predicts the acclimation of key photosynthetic traits based on eco-evolutionary optimality principles. Specifically, it rests on two principles: The Coordination Hypothesis by <span class="citation" data-cites="maire2012coordination">Maire et al. (<a href="references.html#ref-maire2012coordination" role="doc-biblioref">2012</a>)</span> stating that a leaf coordinates its two limiting</p>
</section>
<section id="an-analytic-approach" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="an-analytic-approach"><span class="header-section-number">5.2</span> An Analytic Approach</h2>
<ul>
<li><p>Make clear that this is only the optimally achieved leaf temperature and not the instantaneous one</p></li>
<li><p>But state that this explicitly includes the regulation of thermoregulation and thermal acclimation</p></li>
</ul>
</section>
<section id="a-numeric-approach" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="a-numeric-approach"><span class="header-section-number">5.3</span> A Numeric Approach</h2>


<div id="refs" class="references csl-bib-body hanging-indent" data-line-spacing="2" role="list" style="display: none">
<div id="ref-berry1980photosynthetic" class="csl-entry" role="listitem">
Berry, J., &amp; Bjorkman, O. (1980). Photosynthetic Response and Adaptation to Temperature in Higher Plants. <em>Annual Review of Plant Physiology</em>, <em>31</em>(1), 491–543. <a href="https://doi.org/10.1146/annurev.pp.31.060180.002423">https://doi.org/10.1146/annurev.pp.31.060180.002423</a>
</div>
<div id="ref-maire2012coordination" class="csl-entry" role="listitem">
Maire, V., Martre, P., Kattge, J., Gastal, F., Esser, G., Fontaine, S., &amp; Soussana, J.-F. (2012). The Coordination of Leaf Photosynthesis Links C and N Fluxes in C3 Plant Species. <em>PLoS ONE</em>, <em>7</em>(6), e38345. <a href="https://doi.org/10.1371/journal.pone.0038345">https://doi.org/10.1371/journal.pone.0038345</a>
</div>
<div id="ref-peng2021global" class="csl-entry" role="listitem">
Peng, Y., Bloomfield, K. J., Cernusak, L. A., Domingues, T. F., &amp; Colin Prentice, I. (2021). Global climate and nutrient controls of photosynthetic capacity. <em>Communications Biology</em>, <em>4</em>(1), 462. <a href="https://doi.org/10.1038/s42003-021-01985-7">https://doi.org/10.1038/s42003-021-01985-7</a>
</div>
<div id="ref-prentice2014balancing" class="csl-entry" role="listitem">
Prentice, I. C., Dong, N., Gleason, M. S., Maire, V., &amp; Wright, J. I. (2014). Balancing the costs of carbon gain and water transport: Testing a new theoretical framework for plant functional ecology. <em>Ecology Letters</em>, <em>17</em>(1), 8291. <a href="https://doi.org/gf9w4m">https://doi.org/gf9w4m</a>
</div>
<div id="ref-rogers2014use" class="csl-entry" role="listitem">
Rogers, A. (2014). The use and misuse of Vcmax in Earth System Models. <em>Photosynthesis Research</em>, <em>119</em>(1-2), 15–29. <a href="https://doi.org/10.1007/s11120-013-9818-1">https://doi.org/10.1007/s11120-013-9818-1</a>
</div>
<div id="ref-stocker2020pmodel" class="csl-entry" role="listitem">
Stocker, B. D., Wang, H., Smith, N. G., Harrison, S. P., Keenan, T. F., Sandoval, D., Davis, T., &amp; Prentice, I. C. (2020). P-model v1.0: an optimality-based light use efficiency model for simulating ecosystem gross primary production. <em>Geoscientific Model Development</em>, <em>13</em>(3), 1545–1581. <a href="https://doi.org/10.5194/gmd-13-1545-2020">https://doi.org/10.5194/gmd-13-1545-2020</a>
</div>
<div id="ref-stocker2021rpmodel" class="csl-entry" role="listitem">
Stocker, B., &amp; Hufkens, K. (2021). <em>Rpmodel v1.2.0: R package implementing the p-model</em>. Zenodo. <a href="https://doi.org/10.5281/ZENODO.3359706">https://doi.org/10.5281/ZENODO.3359706</a>
</div>
</div>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'alternate';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./01-introduction.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./03-implementation.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Algorithm</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>