[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Leaf Energy Balance Tutorial",
    "section": "",
    "text": "About\nThis is an online tutorial to simulate a leaf’s energy balance to different drivers.\n\n\nRequirements\n\nsource(here::here(\"R/_setup.R\"))\n\n\nsessionInfo()\n\nR version 4.3.1 (2023-06-16)\nPlatform: aarch64-apple-darwin20 (64-bit)\nRunning under: macOS Ventura 13.4.1\n\nMatrix products: default\nBLAS:   /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/lib/libRblas.0.dylib \nLAPACK: /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.11.0\n\nlocale:\n[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8\n\ntime zone: Europe/Zurich\ntzcode source: internal\n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n [1] conflicted_1.2.0 quarto_1.2       rpmodel_1.2.0    patchwork_1.1.3 \n [5] lubridate_1.9.2  forcats_1.0.0    stringr_1.5.0    dplyr_1.1.2     \n [9] purrr_1.0.2      readr_2.1.4      tidyr_1.3.0      tibble_3.2.1    \n[13] ggplot2_3.4.3    tidyverse_2.0.0  here_1.0.1      \n\nloaded via a namespace (and not attached):\n [1] utf8_1.2.3        generics_0.1.3    stringi_1.7.12    hms_1.1.3        \n [5] digest_0.6.33     magrittr_2.0.3    evaluate_0.21     grid_4.3.1       \n [9] timechange_0.2.0  fastmap_1.1.1     rprojroot_2.0.3   jsonlite_1.8.7   \n[13] processx_3.8.2    ps_1.7.5          fansi_1.0.4       scales_1.2.1     \n[17] cli_3.6.1         rlang_1.1.1       munsell_0.5.0     cachem_1.0.8     \n[21] withr_2.5.0       yaml_2.3.7        tools_4.3.1       tzdb_0.4.0       \n[25] memoise_2.0.1     colorspace_2.1-0  vctrs_0.6.3       R6_2.5.1         \n[29] lifecycle_1.0.3   htmlwidgets_1.6.2 pkgconfig_2.0.3   pillar_1.9.0     \n[33] later_1.3.1       gtable_0.3.3      glue_1.6.2        Rcpp_1.0.11      \n[37] xfun_0.40         tidyselect_1.2.0  rstudioapi_0.15.0 knitr_1.43       \n[41] htmltools_0.5.6   rmarkdown_2.24    compiler_4.3.1   \n\n\n\nrenv::diagnostics()\n\nDiagnostics Report [renv 0.17.3]\n================================\n\n# Session Info =======================\nR version 4.3.1 (2023-06-16)\nPlatform: aarch64-apple-darwin20 (64-bit)\nRunning under: macOS Ventura 13.4.1\n\nMatrix products: default\nBLAS:   /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/lib/libRblas.0.dylib \nLAPACK: /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.11.0\n\nlocale:\n[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8\n\ntime zone: Europe/Zurich\ntzcode source: internal\n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n [1] conflicted_1.2.0 quarto_1.2       rpmodel_1.2.0    patchwork_1.1.3 \n [5] lubridate_1.9.2  forcats_1.0.0    stringr_1.5.0    dplyr_1.1.2     \n [9] purrr_1.0.2      readr_2.1.4      tidyr_1.3.0      tibble_3.2.1    \n[13] ggplot2_3.4.3    tidyverse_2.0.0  here_1.0.1      \n\nloaded via a namespace (and not attached):\n [1] utf8_1.2.3        generics_0.1.3    renv_0.17.3       stringi_1.7.12   \n [5] hms_1.1.3         digest_0.6.33     magrittr_2.0.3    evaluate_0.21    \n [9] grid_4.3.1        timechange_0.2.0  fastmap_1.1.1     rprojroot_2.0.3  \n[13] jsonlite_1.8.7    processx_3.8.2    ps_1.7.5          fansi_1.0.4      \n[17] scales_1.2.1      cli_3.6.1         rlang_1.1.1       munsell_0.5.0    \n[21] cachem_1.0.8      withr_2.5.0       yaml_2.3.7        tools_4.3.1      \n[25] tzdb_0.4.0        memoise_2.0.1     colorspace_2.1-0  vctrs_0.6.3      \n[29] R6_2.5.1          lifecycle_1.0.3   htmlwidgets_1.6.2 pkgconfig_2.0.3  \n[33] pillar_1.9.0      later_1.3.1       gtable_0.3.3      glue_1.6.2       \n[37] Rcpp_1.0.11       xfun_0.40         tidyselect_1.2.0  rstudioapi_0.15.0\n[41] knitr_1.43        htmltools_0.5.6   rmarkdown_2.24    compiler_4.3.1   \n\n# Project ============================\nProject path: \"~/repos/padasch/leaf_energy_balance_tutorial\"\n\n# Status =============================\n* The project is already synchronized with the lockfile.\n\n# Packages ===========================\n                      Library Source    Lockfile Source Path Dependency\nAsioHeaders          1.22.1-2   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nBH                   1.81.0-1   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nBayesianTools           0.1.8   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nBrobdingnag             1.2-9   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nDBI                     1.1.3   CRAN        &lt;NA&gt;   &lt;NA&gt;  [1]       &lt;NA&gt;\nDHARMa                  0.4.6   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nDT                       0.28   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nFormula                 1.2-5   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nGenSA                   1.1.9   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nIDPmisc                1.1.20   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nKernSmooth            2.23-21   CRAN        &lt;NA&gt;   &lt;NA&gt;  [2]       &lt;NA&gt;\nMASS                   7.3-60   CRAN        &lt;NA&gt;   &lt;NA&gt;  [2]       &lt;NA&gt;\nMODISTools              1.1.4   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nMatrix                1.5-4.1   CRAN        &lt;NA&gt;   &lt;NA&gt;  [2]       &lt;NA&gt;\nMetrics                 0.1.4   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nModelMetrics          1.2.2.2   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nR.cache                0.16.0   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nR.methodsS3             1.8.2   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nR.oo                   1.25.0   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nR.utils                2.12.2   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nR6                      2.5.1   CRAN       2.5.1   CRAN  [1]   indirect\nRApiSerialize           0.1.2   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nRColorBrewer            1.1-3   CRAN        &lt;NA&gt;   &lt;NA&gt;  [1]       &lt;NA&gt;\nRSpectra               0.16-1   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nRcgmin              2022-4.30   CRAN   2022-4.30   CRAN  [1]   indirect\nRcpp                   1.0.11   CRAN        &lt;NA&gt;   &lt;NA&gt;  [1]       &lt;NA&gt;\nRcppArmadillo      0.12.4.1.0   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nRcppEigen           0.3.3.9.3   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nRcppParallel            5.1.7   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nRcppRoll                0.3.0   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nRcppTOML                0.2.2   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nRcppThread              2.1.5   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nRvmmin            2018-4.17.1   CRAN 2018-4.17.1   CRAN  [1]   indirect\nSQUAREM                2021.1   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nTTR                    0.24.3   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nanytime                 0.3.9   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nape                     5.7-1   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\naskpass                   1.1   CRAN        &lt;NA&gt;   &lt;NA&gt;  [1]       &lt;NA&gt;\nassertthat              0.2.1   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\naudio                  0.1-10   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nbackports               1.4.1   CRAN        &lt;NA&gt;   &lt;NA&gt;  [1]       &lt;NA&gt;\nbase64enc               0.1-3   CRAN       0.1-3   CRAN  [1]   indirect\nbeepr                     1.3   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nbit                     4.0.5   CRAN        &lt;NA&gt;   &lt;NA&gt;  [1]       &lt;NA&gt;\nbit64                   4.0.5   CRAN        &lt;NA&gt;   &lt;NA&gt;  [1]       &lt;NA&gt;\nblob                    1.2.4   CRAN        &lt;NA&gt;   &lt;NA&gt;  [1]       &lt;NA&gt;\nbookdown                 0.34   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nboot                 1.3-28.1   CRAN        &lt;NA&gt;   &lt;NA&gt;  [2]       &lt;NA&gt;\nbrew                    1.0-8   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nbridgesampling          1.1-2   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nbrio                    1.1.3   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nbroom                   1.0.5   CRAN        &lt;NA&gt;   &lt;NA&gt;  [1]       &lt;NA&gt;\nbslib                   0.5.1   CRAN       0.5.1   CRAN  [1]   indirect\ncachem                  1.0.8   CRAN       1.0.8   CRAN  [1]   indirect\ncallr                   3.7.3   CRAN        &lt;NA&gt;   &lt;NA&gt;  [1]       &lt;NA&gt;\ncaret                  6.0-94   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\ncellranger              1.1.0   CRAN        &lt;NA&gt;   &lt;NA&gt;  [1]       &lt;NA&gt;\ncheckmate               2.2.0   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nclass                  7.3-22   CRAN        &lt;NA&gt;   &lt;NA&gt;  [2]       &lt;NA&gt;\nclassInt                0.4-9   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\ncli                     3.6.1   CRAN       3.6.1   CRAN  [1]   indirect\nclipr                   0.8.0   CRAN        &lt;NA&gt;   &lt;NA&gt;  [1]       &lt;NA&gt;\nclock                   0.7.0   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nclue                   0.3-64   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\ncluster                 2.1.4   CRAN        &lt;NA&gt;   &lt;NA&gt;  [2]       &lt;NA&gt;\ncoda                   0.19-4   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\ncodetools              0.2-19   CRAN        &lt;NA&gt;   &lt;NA&gt;  [2]       &lt;NA&gt;\ncollections             0.3.7   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\ncolorspace              2.1-0   CRAN        &lt;NA&gt;   &lt;NA&gt;  [1]       &lt;NA&gt;\ncommonmark              1.9.0   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nconflicted              1.2.0   CRAN        &lt;NA&gt;   &lt;NA&gt;  [1]       &lt;NA&gt;\ncowplot                 1.1.1   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\ncpp11                   0.4.6   CRAN        &lt;NA&gt;   &lt;NA&gt;  [1]       &lt;NA&gt;\ncrayon                  1.5.2   CRAN        &lt;NA&gt;   &lt;NA&gt;  [1]       &lt;NA&gt;\ncredentials             1.3.2   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\ncrosstalk               1.2.0   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\ncurl                    5.0.2   CRAN        &lt;NA&gt;   &lt;NA&gt;  [1]       &lt;NA&gt;\ncyclocomp               1.1.0   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\ndata.table             1.14.8   CRAN        &lt;NA&gt;   &lt;NA&gt;  [1]       &lt;NA&gt;\ndbplyr                  2.3.3   CRAN        &lt;NA&gt;   &lt;NA&gt;  [1]       &lt;NA&gt;\ndesc                    1.4.2   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\ndiagram                 1.6.5   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\ndiffobj                 0.3.5   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\ndigest                 0.6.33   CRAN      0.6.33   CRAN  [1]   indirect\ndoParallel             1.0.17   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\ndplyr                   1.1.2   CRAN        &lt;NA&gt;   &lt;NA&gt;  [1]       &lt;NA&gt;\ndtplyr                  1.3.1   CRAN        &lt;NA&gt;   &lt;NA&gt;  [1]       &lt;NA&gt;\ndtw                    1.23-1   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\ndtwclust               5.5.12   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\ne1071                  1.7-13   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nellipse                 0.5.0   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nellipsis                0.3.2   CRAN       0.3.2   CRAN  [1]   indirect\nemulator               1.2-21   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nevaluate                 0.21   CRAN        0.21   CRAN  [1]   indirect\nexpm                  0.999-7   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nfansi                   1.0.4   CRAN        &lt;NA&gt;   &lt;NA&gt;  [1]       &lt;NA&gt;\nfarver                  2.1.1   CRAN        &lt;NA&gt;   &lt;NA&gt;  [1]       &lt;NA&gt;\nfastmap                 1.1.1   CRAN       1.1.1   CRAN  [1]   indirect\nflexclust               1.4-1   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nfontawesome             0.5.1   CRAN       0.5.1   CRAN  [1]   indirect\nforcats                 1.0.0   CRAN        &lt;NA&gt;   &lt;NA&gt;  [1]       &lt;NA&gt;\nforeach                 1.5.2   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nforecast                 8.21   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nforeign                0.8-84   CRAN        &lt;NA&gt;   &lt;NA&gt;  [2]       &lt;NA&gt;\nfracdiff                1.5-2   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nfs                      1.6.3   CRAN       1.6.3   CRAN  [1]   indirect\nfurrr                   0.3.1   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nfuture                 1.33.0   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nfuture.apply           1.11.0   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\ngap                     1.5-1   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\ngap.datasets            0.0.5   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\ngargle                  1.5.2   CRAN        &lt;NA&gt;   &lt;NA&gt;  [1]       &lt;NA&gt;\ngenerics                0.1.3   CRAN        &lt;NA&gt;   &lt;NA&gt;  [1]       &lt;NA&gt;\ngert                    1.9.2   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nggplot2                 3.4.3   CRAN        &lt;NA&gt;   &lt;NA&gt;  [1]       &lt;NA&gt;\nggrepel                 0.9.3   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nggridges                0.5.4   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\ngh                      1.4.0   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\ngitcreds                0.1.2   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nglobals                0.16.2   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nglue                    1.6.2   CRAN       1.6.2   CRAN  [1]   indirect\ngmm                       1.8   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\ngoogledrive             2.1.1   CRAN        &lt;NA&gt;   &lt;NA&gt;  [1]       &lt;NA&gt;\ngooglesheets4           1.1.1   CRAN        &lt;NA&gt;   &lt;NA&gt;  [1]       &lt;NA&gt;\ngower                   1.0.1   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\ngrDevices                &lt;NA&gt;   &lt;NA&gt;        &lt;NA&gt;   &lt;NA&gt;  [2]   indirect\ngraphics                 &lt;NA&gt;   &lt;NA&gt;        &lt;NA&gt;   &lt;NA&gt;  [2]   indirect\ngridExtra                 2.3   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\ngtable                  0.3.3   CRAN        &lt;NA&gt;   &lt;NA&gt;  [1]       &lt;NA&gt;\nhardhat                 1.3.0   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nhaven                   2.5.3   CRAN        &lt;NA&gt;   &lt;NA&gt;  [1]       &lt;NA&gt;\nhere                    1.0.1   CRAN       1.0.1   CRAN  [1]     direct\nhexbin                 1.28.3   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nhighr                    0.10   CRAN        0.10   CRAN  [1]   indirect\nhms                     1.1.3   CRAN        &lt;NA&gt;   &lt;NA&gt;  [1]       &lt;NA&gt;\nhtmltools               0.5.6   CRAN       0.5.6   CRAN  [1]   indirect\nhtmlwidgets             1.6.2   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nhttpuv                 1.6.11   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nhttr                    1.4.7   CRAN        &lt;NA&gt;   &lt;NA&gt;  [1]       &lt;NA&gt;\nhttr2                   0.2.3   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nhwsdr                     1.0   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nids                     1.0.1   CRAN        &lt;NA&gt;   &lt;NA&gt;  [1]       &lt;NA&gt;\niml                    0.11.1   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nini                     0.3.1   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nipred                  0.9-14   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nisoband                 0.2.7   CRAN        &lt;NA&gt;   &lt;NA&gt;  [1]       &lt;NA&gt;\niterators              1.0.14   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\njquerylib               0.1.4   CRAN       0.1.4   CRAN  [1]   indirect\njsonlite                1.8.7   CRAN       1.8.7   CRAN  [1]   indirect\nknitr                    1.43   CRAN        1.43   CRAN  [1]     direct\nlabeling                0.4.2   CRAN        &lt;NA&gt;   &lt;NA&gt;  [1]       &lt;NA&gt;\nlanguageserver         0.3.15   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nlater                   1.3.1   CRAN        &lt;NA&gt;   &lt;NA&gt;  [1]       &lt;NA&gt;\nlattice                0.21-8   CRAN        &lt;NA&gt;   &lt;NA&gt;  [2]       &lt;NA&gt;\nlava                  1.7.2.1   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nlazyeval                0.2.2   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nleaflet                 2.1.2   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nleaflet.providers       1.9.0   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nlifecycle               1.0.3   CRAN       1.0.3   CRAN  [1]   indirect\nlintr                   3.0.2   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nlistenv                 0.9.0   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nlme4                   1.1-34   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nlmtest                 0.9-40   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nlubridate               1.9.2   CRAN        &lt;NA&gt;   &lt;NA&gt;  [1]       &lt;NA&gt;\nmagrittr                2.0.3   CRAN       2.0.3   CRAN  [1]   indirect\nmarkdown                  1.7   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nmemoise                 2.0.1   CRAN       2.0.1   CRAN  [1]   indirect\nmethods                  &lt;NA&gt;   &lt;NA&gt;        &lt;NA&gt;   &lt;NA&gt;  [2]   indirect\nmgcv                   1.8-42   CRAN        &lt;NA&gt;   &lt;NA&gt;  [2]       &lt;NA&gt;\nmime                     0.12   CRAN        0.12   CRAN  [1]   indirect\nminiUI                0.1.1.1   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nminqa                   1.2.5   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nmodelr                 0.1.11   CRAN        &lt;NA&gt;   &lt;NA&gt;  [1]       &lt;NA&gt;\nmodeltools             0.2-23   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nmsm                       1.7   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nmultidplyr              0.1.3   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nmunsell                 0.5.0   CRAN        &lt;NA&gt;   &lt;NA&gt;  [1]       &lt;NA&gt;\nmvtnorm                 1.2-2   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nncdf4                    1.21   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nnlme                  3.1-162   CRAN        &lt;NA&gt;   &lt;NA&gt;  [2]       &lt;NA&gt;\nnloptr                  2.0.3   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nnnet                   7.3-19   CRAN        &lt;NA&gt;   &lt;NA&gt;  [2]       &lt;NA&gt;\nnumDeriv           2016.8-1.1   CRAN  2016.8-1.1   CRAN  [1]   indirect\nnumbers                 0.8-5   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nopenssl                 2.1.0   CRAN        &lt;NA&gt;   &lt;NA&gt;  [1]       &lt;NA&gt;\noptextras           2019-12.4   CRAN   2019-12.4   CRAN  [1]   indirect\noptimr             2019-12.16   CRAN  2019-12.16   CRAN  [1]     direct\npROC                   1.18.4   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\npackrat                 0.9.1   CRAN        &lt;NA&gt;   &lt;NA&gt;  [1]       &lt;NA&gt;\npadr                    0.6.2   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\npagedown                 0.20   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\npandoc                  0.1.0   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nparallelly             1.36.0   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\npatchwork               1.1.3   CRAN        &lt;NA&gt;   &lt;NA&gt;  [1]       &lt;NA&gt;\npdp                     0.8.1   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\npillar                  1.9.0   CRAN        &lt;NA&gt;   &lt;NA&gt;  [1]       &lt;NA&gt;\npkgconfig               2.0.3   CRAN        &lt;NA&gt;   &lt;NA&gt;  [1]       &lt;NA&gt;\npkgload               1.3.2.1   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nplotly                 4.10.2   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nplyr                    1.8.8   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\npng                     0.1-8   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\npraise                  1.0.0   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nprediction             0.3.14   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nprettyunits             1.1.1   CRAN        &lt;NA&gt;   &lt;NA&gt;  [1]       &lt;NA&gt;\nprocessx                3.8.2   CRAN        &lt;NA&gt;   &lt;NA&gt;  [1]       &lt;NA&gt;\nprodlim            2023.03.31   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nprogress                1.2.2   CRAN        &lt;NA&gt;   &lt;NA&gt;  [1]       &lt;NA&gt;\nprogressr              0.14.0   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\npromises              1.2.0.1   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nproxy                  0.4-27   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nps                      1.7.5   CRAN        &lt;NA&gt;   &lt;NA&gt;  [1]       &lt;NA&gt;\npurrr                   1.0.2   CRAN        &lt;NA&gt;   &lt;NA&gt;  [1]       &lt;NA&gt;\nqgam                    1.3.4   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nqs                     0.25.5   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nquadprog                1.5-8   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nquantmod               0.4.24   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nquarto                    1.2   CRAN        &lt;NA&gt;   &lt;NA&gt;  [1]       &lt;NA&gt;\nragg                    1.2.5   CRAN        &lt;NA&gt;   &lt;NA&gt;  [1]       &lt;NA&gt;\nranger                 0.15.1   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nrappdirs                0.3.3   CRAN       0.3.3   CRAN  [1]   indirect\nraster                 3.6-20   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nreadr                   2.1.4   CRAN        &lt;NA&gt;   &lt;NA&gt;  [1]       &lt;NA&gt;\nreadxl                  1.4.3   CRAN        &lt;NA&gt;   &lt;NA&gt;  [1]       &lt;NA&gt;\nrecipes                 1.0.7   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nrematch                 1.0.1   CRAN        &lt;NA&gt;   &lt;NA&gt;  [1]       &lt;NA&gt;\nrematch2                2.1.2   CRAN        &lt;NA&gt;   &lt;NA&gt;  [1]       &lt;NA&gt;\nremotes                 2.4.2   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nrenv                   0.17.3   CRAN      0.17.3   CRAN  [1]     direct\nrepr                    1.1.6   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nreprex                  2.0.2   CRAN        &lt;NA&gt;   &lt;NA&gt;  [1]       &lt;NA&gt;\nreshape2                1.4.4   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nreticulate               1.30   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nrex                     1.2.1   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nrlang                   1.1.1   CRAN       1.1.1   CRAN  [1]   indirect\nrmarkdown                2.24   CRAN        2.24   CRAN  [1]     direct\nroxygen2                7.2.3   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nrpart                  4.1.19   CRAN        &lt;NA&gt;   &lt;NA&gt;  [2]       &lt;NA&gt;\nrpart.plot              3.1.1   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nrpmodel                 1.2.0   CRAN       1.2.0   CRAN  [1]     direct\nrprojroot               2.0.3   CRAN       2.0.3   CRAN  [1]   indirect\nrsample                 1.1.1   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nrsconnect               1.0.1   CRAN        &lt;NA&gt;   &lt;NA&gt;  [1]       &lt;NA&gt;\nrstudioapi             0.15.0   CRAN        &lt;NA&gt;   &lt;NA&gt;  [1]       &lt;NA&gt;\nrvest                   1.0.3   CRAN        &lt;NA&gt;   &lt;NA&gt;  [1]       &lt;NA&gt;\ns2                      1.1.4   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nsandwich                3.0-2   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nsass                    0.4.7   CRAN       0.4.7   CRAN  [1]   indirect\nscales                  1.2.1   CRAN        &lt;NA&gt;   &lt;NA&gt;  [1]       &lt;NA&gt;\nscico                   1.5.0   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nselectr                 0.4-2   CRAN        &lt;NA&gt;   &lt;NA&gt;  [1]       &lt;NA&gt;\nsensitivity            1.28.1   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nservr                    0.27   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nsessioninfo             1.2.2   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nsetRNG               2022.4-1   CRAN    2022.4-1   CRAN  [1]   indirect\nsf                     1.0-13   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nshape                   1.4.6   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nshiny                 1.7.4.1   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nshinyBS                0.61.1   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nshinyjs                 2.1.0   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nskimr                   2.1.5   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nslider                  0.3.0   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nsourcetools           0.1.7-1   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nsp                      2.0-0   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nspatial                7.3-16   CRAN        &lt;NA&gt;   &lt;NA&gt;  [2]       &lt;NA&gt;\nstats                    &lt;NA&gt;   &lt;NA&gt;        &lt;NA&gt;   &lt;NA&gt;  [2]   indirect\nstringfish             0.15.8   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nstringi                1.7.12   CRAN      1.7.12   CRAN  [1]   indirect\nstringr                 1.5.0   CRAN       1.5.0   CRAN  [1]   indirect\nstyler                 1.10.1   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nsurvival                3.5-5   CRAN        &lt;NA&gt;   &lt;NA&gt;  [2]       &lt;NA&gt;\nsys                     3.4.2   CRAN        &lt;NA&gt;   &lt;NA&gt;  [1]       &lt;NA&gt;\nsystemfonts             1.0.4   CRAN        &lt;NA&gt;   &lt;NA&gt;  [1]       &lt;NA&gt;\nterra                  1.7-39   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\ntestthat               3.1.10   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\ntextshaping             0.3.6   CRAN        &lt;NA&gt;   &lt;NA&gt;  [1]       &lt;NA&gt;\ntibble                  3.2.1   CRAN        &lt;NA&gt;   &lt;NA&gt;  [1]       &lt;NA&gt;\ntictoc                    1.2   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\ntidyr                   1.3.0   CRAN        &lt;NA&gt;   &lt;NA&gt;  [1]       &lt;NA&gt;\ntidyselect              1.2.0   CRAN        &lt;NA&gt;   &lt;NA&gt;  [1]       &lt;NA&gt;\ntidyverse               2.0.0   CRAN        &lt;NA&gt;   &lt;NA&gt;  [1]       &lt;NA&gt;\ntimeDate             4022.108   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\ntimechange              0.2.0   CRAN        &lt;NA&gt;   &lt;NA&gt;  [1]       &lt;NA&gt;\ntimetk                  2.8.3   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\ntinytex                  0.46   CRAN        0.46   CRAN  [1]   indirect\ntmvtnorm                  1.5   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\ntools                    &lt;NA&gt;   &lt;NA&gt;        &lt;NA&gt;   &lt;NA&gt;  [2]   indirect\ntseries               0.10-54   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\ntsfeatures                1.1   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\ntzdb                    0.4.0   CRAN        &lt;NA&gt;   &lt;NA&gt;  [1]       &lt;NA&gt;\nunits                   0.8-2   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nurca                    1.3-3   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nusethis                 2.2.2   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nutf8                    1.2.3   CRAN        &lt;NA&gt;   &lt;NA&gt;  [1]       &lt;NA&gt;\nutils                    &lt;NA&gt;   &lt;NA&gt;        &lt;NA&gt;   &lt;NA&gt;  [2]   indirect\nuuid                    1.1-0   CRAN        &lt;NA&gt;   &lt;NA&gt;  [1]       &lt;NA&gt;\nvctrs                   0.6.3   CRAN       0.6.3   CRAN  [1]   indirect\nvip                     0.3.2   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nviridis                 0.6.4   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nviridisLite             0.4.2   CRAN        &lt;NA&gt;   &lt;NA&gt;  [1]       &lt;NA&gt;\nvisdat                  0.6.0   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nvroom                   1.6.3   CRAN        &lt;NA&gt;   &lt;NA&gt;  [1]       &lt;NA&gt;\nwaldo                   0.5.1   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nwarp                    0.2.0   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nwebsocket               1.4.1   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nwhisker                 0.4.1   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nwhoami                  1.3.0   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nwithr                   2.5.0   CRAN        &lt;NA&gt;   &lt;NA&gt;  [1]       &lt;NA&gt;\nwk                      0.7.3   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nxfun                     0.40   CRAN        0.40   CRAN  [1]   indirect\nxml2                    1.3.5   CRAN        &lt;NA&gt;   &lt;NA&gt;  [1]       &lt;NA&gt;\nxmlparsedata            1.0.5   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nxtable                  1.8-4   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nxts                    0.13.1   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nyaml                    2.3.7   CRAN       2.3.7   CRAN  [1]   indirect\nyardstick               1.2.0   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nymlthis                 0.1.7   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nzip                     2.3.0   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\nzoo                    1.8-12   CRAN        &lt;NA&gt;   &lt;NA&gt;  [3]       &lt;NA&gt;\n\n[1]: /Users/pascal/repos/padasch/leaf_energy_balance_tutorial/renv/library/R-4.3/aarch64-apple-darwin20\n[2]: /Users/pascal/Library/Caches/org.R-project.R/R/renv/sandbox/R-4.3/aarch64-apple-darwin20/84ba8b13 \n[3]: /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/library                              \n\n# ABI ================================\n* No ABI conflicts were detected in the set of installed packages.\n\n# User Profile =======================\n[no user profile detected]\n\n# Settings ===========================\nList of 11\n $ bioconductor.version     : NULL\n $ external.libraries       : chr(0) \n $ ignored.packages         : chr(0) \n $ package.dependency.fields: chr [1:3] \"Imports\" \"Depends\" \"LinkingTo\"\n $ r.version                : NULL\n $ snapshot.type            : chr \"implicit\"\n $ use.cache                : logi TRUE\n $ vcs.ignore.cellar        : logi TRUE\n $ vcs.ignore.library       : logi TRUE\n $ vcs.ignore.local         : logi TRUE\n $ vcs.manage.ignores       : logi TRUE\n\n# Options ============================\nList of 7\n $ defaultPackages                     : chr [1:6] \"datasets\" \"utils\" \"grDevices\" \"graphics\" ...\n $ download.file.method                : NULL\n $ download.file.extra                 : NULL\n $ install.packages.compile.from.source: chr \"interactive\"\n $ pkgType                             : chr \"both\"\n $ repos                               : Named chr \"@CRAN@\"\n  ..- attr(*, \"names\")= chr \"CRAN\"\n $ renv.verbose                        : logi TRUE\n\n# Environment Variables ==============\nHOME                        = /Users/pascal\nLANG                        = en_US.UTF-8\nMAKE                        = make\nR_LIBS                      = &lt;NA&gt;\nR_LIBS_SITE                 = /Library/Frameworks/R.framework/Resources/site-library\nR_LIBS_USER                 = /Users/pascal/repos/padasch/leaf_energy_balance_tutorial/renv/library/R-4.3/aarch64-apple-darwin20:/Users/pascal/Library/Caches/org.R-project.R/R/renv/sandbox/R-4.3/aarch64-apple-darwin20/84ba8b13\nRENV_DEFAULT_R_ENVIRON      = &lt;NA&gt;\nRENV_DEFAULT_R_ENVIRON_USER = &lt;NA&gt;\nRENV_DEFAULT_R_LIBS         = &lt;NA&gt;\nRENV_DEFAULT_R_LIBS_SITE    = /Library/Frameworks/R.framework/Resources/site-library\nRENV_DEFAULT_R_LIBS_USER    = /Users/pascal/Library/R/arm64/4.3/library\nRENV_DEFAULT_R_PROFILE      = &lt;NA&gt;\nRENV_DEFAULT_R_PROFILE_USER = &lt;NA&gt;\nRENV_PROJECT                = /Users/pascal/repos/padasch/leaf_energy_balance_tutorial\n\n# PATH ===============================\n- /Users/pascal/anaconda3/bin\n- /usr/local/gfortran/bin\n- /Library/Frameworks/R.framework/Resources\n- /usr/local/bin\n- /System/Cryptexes/App/usr/bin\n- /usr/bin\n- /bin\n- /usr/sbin\n- /sbin\n- /Library/TeX/texbin\n- /Applications/quarto/bin\n- /var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/local/bin\n- /var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/bin\n- /var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/appleinternal/bin\n- /Users/pascal/anaconda3/bin\n- /usr/local/gfortran/bin\n- /Library/Frameworks/R.framework/Resources\n- /Users/pascal/anaconda3/condabin\n- /Users/pascal/Applications/quarto/bin\n- /usr/texbin\n- /Applications/RStudio.app/Contents/Resources/app/bin/postback\n\n# Cache ==============================\nThere are a total of 413 packages installed in the renv cache.\nCache path: \"~/Library/Caches/org.R-project.R/R/renv/cache/v5/R-4.3/aarch64-apple-darwin20\""
  },
  {
    "objectID": "01-introduction.html",
    "href": "01-introduction.html",
    "title": "1  Introduction",
    "section": "",
    "text": "Introduce different terminology like poikilothermy and so on"
  },
  {
    "objectID": "02-theory.html",
    "href": "02-theory.html",
    "title": "2  Theory",
    "section": "",
    "text": "3 Relevance of Predicting Leaf Temperatures"
  },
  {
    "objectID": "02-theory.html#background",
    "href": "02-theory.html#background",
    "title": "2  Theory",
    "section": "5.1 Background",
    "text": "5.1 Background\nThe P-Model - the “P” stands for “Productivity) - is a photosynthesis model that predicts the acclimation of key photosynthetic traits based on eco-evolutionary optimality principles. Specifically, it rests on two principles: The Coordination Hypothesis by Maire et al. (2012) stating that a leaf coordinates its two limiting"
  },
  {
    "objectID": "02-theory.html#an-analytic-approach",
    "href": "02-theory.html#an-analytic-approach",
    "title": "2  Theory",
    "section": "5.2 An Analytic Approach",
    "text": "5.2 An Analytic Approach\n\nMake clear that this is only the optimally achieved leaf temperature and not the instantaneous one\nBut state that this explicitly includes the regulation of thermoregulation and thermal acclimation"
  },
  {
    "objectID": "02-theory.html#a-numeric-approach",
    "href": "02-theory.html#a-numeric-approach",
    "title": "2  Theory",
    "section": "5.3 A Numeric Approach",
    "text": "5.3 A Numeric Approach\n\n\n\n\nBerry, J., & Bjorkman, O. (1980). Photosynthetic Response and Adaptation to Temperature in Higher Plants. Annual Review of Plant Physiology, 31(1), 491–543. https://doi.org/10.1146/annurev.pp.31.060180.002423\n\n\nMaire, V., Martre, P., Kattge, J., Gastal, F., Esser, G., Fontaine, S., & Soussana, J.-F. (2012). The Coordination of Leaf Photosynthesis Links C and N Fluxes in C3 Plant Species. PLoS ONE, 7(6), e38345. https://doi.org/10.1371/journal.pone.0038345\n\n\nPeng, Y., Bloomfield, K. J., Cernusak, L. A., Domingues, T. F., & Colin Prentice, I. (2021). Global climate and nutrient controls of photosynthetic capacity. Communications Biology, 4(1), 462. https://doi.org/10.1038/s42003-021-01985-7\n\n\nPrentice, I. C., Dong, N., Gleason, M. S., Maire, V., & Wright, J. I. (2014). Balancing the costs of carbon gain and water transport: Testing a new theoretical framework for plant functional ecology. Ecology Letters, 17(1), 8291. https://doi.org/gf9w4m\n\n\nRogers, A. (2014). The use and misuse of Vcmax in Earth System Models. Photosynthesis Research, 119(1-2), 15–29. https://doi.org/10.1007/s11120-013-9818-1\n\n\nStocker, B. D., Wang, H., Smith, N. G., Harrison, S. P., Keenan, T. F., Sandoval, D., Davis, T., & Prentice, I. C. (2020). P-model v1.0: an optimality-based light use efficiency model for simulating ecosystem gross primary production. Geoscientific Model Development, 13(3), 1545–1581. https://doi.org/10.5194/gmd-13-1545-2020\n\n\nStocker, B., & Hufkens, K. (2021). Rpmodel v1.2.0: R package implementing the p-model. Zenodo. https://doi.org/10.5281/ZENODO.3359706"
  },
  {
    "objectID": "03-implementation.html#description",
    "href": "03-implementation.html#description",
    "title": "3  Algorithm",
    "section": "3.1 Description",
    "text": "3.1 Description\nThe goal of this algorithm is to predict a leaf temperature at which the costs for maintaining photosynthesis are minimal. To do this, two optimization algorithms are required as displayed in Figure 3.1, the numerical P-Model algorithm and the energy balance algorithm.\nThe numerical P-Model algorithm solves the optimization problem to find the values for \\(V_{cmax}\\), \\(J_{max}\\), and \\(g_{s}\\) at which the carbon costs for maintaining photosynthesis are minimal (explained in Chapter 2):\n\\[\n\\frac{\\beta \\;V_{cmax} + 1.6\\;D\\;g_s + c \\;J_{max} }{A_{gross}} = min.\n\\]\nThe energy balance algorithm searches for the leaf temperature that closes the energy budget described in Chapter 4. Certain terms within the energy balance depend on assuming a leaf temperature in the first place. This turns the algorithm into an optimization problem where the goal is to minimze the difference between the initially assumed leaf temperature (\\(T_{\\text{leaf, init}}\\)) and the leaf temperature that closes the energy balance (\\(T_{\\text{leaf, eb}}\\)):\n\\[\nT_{\\text{leaf, init}} - T_{\\text{leaf, eb}} = min.\n\\]\nThe algorithm visualized in Figure 3.1 reads as follows:\n1. Pick random values for vcmax, jmax, gs\n2. Pick random value for tc_leaf (initial leaf temperature)\n3. Calculate the energy balanced given tc_leaf, gs, abiotic environment\n4. Check if initial tc_leaf equals tc_leaf that closes the energy balance:\n   If false, re-run energy balance with a new tc_leaf\n   If true, then proceed\n5. Use tc_leaf, vcmax, jmax, gs, abiotic environment to calculate the carbon costs\n6. Check if carbon costs are minimal\n   If false, re-start at 1. with new parameters for vcmax, jmax, and gs\n   If true, return tc_leaf, vcmax, jmax, gs\n\nDescribe all functions used in here\nFunctions needed\n\nNumerical optimization routine for\n\nLeaf Energy Balance\nFor Vcmax/gs\n\nCost function\nVisualise cost optimization\n\nExplain nested optimization\n\nClosing the Energy Balance\nCost Minimization\n\n\n\n\n\n\n\nFigure 3.1: Algorithm for calculating optimal traits using the numerical P-Model coupled to a leaf energy balance model. The numerical P-Model parts are in purple. The energy balance model parts are in organge. Note that \\(J_{max}\\) is implemented here for reasons of completeness. The current optimization routine does not properly optimize \\(J_{max}\\)."
  },
  {
    "objectID": "03-implementation.html#implementation",
    "href": "03-implementation.html#implementation",
    "title": "3  Algorithm",
    "section": "3.2 Implementation",
    "text": "3.2 Implementation\nThe individual algorithms described above are based on two functions - one function to calculate the quantitiy to be optimized and one function for handling the optimization. Below are demonstrations for calling the algorithms separately and coupled. All functions can be found in the R directory of this repository.\n\n# Get standard conditions for abiotic and biotic conditions:\ntc_air  &lt;- 25     # degC\ntc_leaf &lt;- 30     # degC\nvpd_air &lt;- 2000   # Pa\npatm    &lt;- 101325 # Pa\nco2     &lt;- 400    # ppm\nppfd    &lt;- 500e-6 # mol/m2/s\nvcmax   &lt;- 50e-6  # mol/m2/s\njmax    &lt;- 100e-6 # mol/m2/s\ngs      &lt;- 1.5e-6 # mol CO2 /m2/s/Pa\nfapar   &lt;- 1      # -\nkphio   &lt;- 0.087  # -\nbeta    &lt;- 146    # -\nc_cost  &lt;- 0.103  # -\nwind          &lt;-  2    # m/s\nleaf_size     &lt;-  0.02 # m\nstomata_ratio &lt;-  1    # -\nleaf_abs      &lt;-  0.5  # -\n\n\n3.2.1 Numerical P-Model\nBelow is a demonstration of the numerical P-Model algorithm without considering the leaf energy balance. Comparing the results of the numerical P-Model against the analytical P-Model shows that they achieve a similar \\(\\chi \\approx0.68\\) but with quite different values for \\(V_{cmax}\\), \\(J_{cmax}\\), and \\(g_{s}\\)\n\n# Analytical P-Model\nrpmodel::rpmodel(\n  tc = tc_air, \n  vpd = vpd_air, \n  co2 = co2, \n  fapar = 1, \n  ppfd = ppfd, \n  patm = patm, \n  kphio = kphio\n) |&gt; as_tibble() |&gt; knitr::kable()\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\ngpp\nca\ngammastar\nkmm\nns_star\nchi\nxi\nmj\nmc\nci\niwue\ngs\nvcmax\nvcmax25\njmax\njmax25\nrd\n\n\n\n\n0.0001183\n40.53\n4.332\n70.84225\n1\n0.6868433\n82.82301\n0.6439624\n0.2382018\n27.83776\n7.93265\n8e-07\n4.13e-05\n4.13e-05\n6.53e-05\n6.53e-05\n6e-07\n\n\n\n\n\n\n# Numerical P-Model\noptimize_traits_and_costs(\n  tc_air = tc_air,\n  vpd_air = vpd_air,\n  patm = patm,\n  co2 = co2,\n  ppfd = ppfd,\n  kphio = kphio\n) |&gt; knitr::kable()\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nvcmax\njmax\ngs\nci\nchi\na_c\na_j\na_gross\nci_c\nci_j\ncost_transp\ncost_vcmax\ncost_jmax\ncarbon_costs\ninclude_energy_balance\ntc_air\ntc_leaf\n\n\n\n\n7.8e-05\n0.0004173\n1.5e-06\n27.79729\n0.6858447\n1.85e-05\n1.86e-05\n1.85e-05\n27.79729\n27.79325\n402.6706\n983.3292\n3.713537\n867.3698\nFALSE\n25\n25\n\n\n\n\n\n\n3.2.1.1 Relevant Functions\n\n\n\n\n\n\ncalculate_traits_and_costs()\n\n\n\n\n\n\n\nfunction (par, tc_air, vpd_air, ppfd, fapar = 1, co2, patm, kphio, \n    beta = 146, maximize = FALSE, return_all = TRUE, units_out = \"per-s\", \n    include_energy_balance = FALSE, ...) \n{\n    vcmax &lt;- par[1]\n    jmax &lt;- par[2]\n    gs &lt;- par[3]\n    if (include_energy_balance == TRUE) {\n        tc_leaf &lt;- optimize_leaf_energy_balance(tc_air = tc_air, \n            vpd_air = vpd_air, gs = gs/3600/24, ppfd = ppfd/3600/24, \n            patm = patm, ...)\n        vpd_leaf &lt;- air_vpd_to_leaf_vpd(vpd_air, tc_air, tc_leaf)\n    }\n    else {\n        tc_leaf &lt;- tc_air\n        vpd_leaf &lt;- vpd_air\n    }\n    kmm &lt;- rpmodel::kmm(tc_leaf, patm)\n    gammastar &lt;- rpmodel::gammastar(tc_leaf, patm)\n    ns_star &lt;- rpmodel::viscosity_h2o(tc_leaf, patm)/rpmodel::viscosity_h2o(25, \n        101325)\n    ca &lt;- rpmodel::co2_to_ca(co2, patm)\n    kphio &lt;- kphio * rpmodel::ftemp_kphio(tc_leaf, c4 = F)\n    iabs &lt;- ppfd * fapar\n    L &lt;- 1/sqrt(1 + ((4 * kphio * iabs)/jmax)^2)\n    A &lt;- -gs\n    B &lt;- gs * ca - 2 * gammastar * gs - L * kphio * iabs\n    C &lt;- 2 * gammastar * gs * ca + L * kphio * iabs * gammastar\n    ci_j &lt;- QUADM(A, B, C)\n    a_j &lt;- kphio * iabs * (ci_j - gammastar)/(ci_j + 2 * gammastar) * \n        L\n    c_cost &lt;- 0.103\n    A &lt;- -1 * gs\n    B &lt;- gs * ca - gs * kmm - vcmax\n    C &lt;- gs * ca * kmm + vcmax * gammastar\n    ci_c &lt;- QUADM(A, B, C)\n    a_c &lt;- vcmax * (ci_c - gammastar)/(ci_c + kmm)\n    ci &lt;- max(ci_c, ci_j)\n    a_gross &lt;- min(a_j, a_c)\n    carbon_costs &lt;- get_carbon_costs(vpd_leaf = vpd_leaf, ns_star = ns_star, \n        gs = gs, vcmax = vcmax, jmax = jmax, beta = beta, c_cost = c_cost, \n        a_gross = a_gross, cost_type = \"relative_carbon_costs\")\n    if (return_all) {\n        if (units_out == \"per-s\") {\n            vcmax &lt;- vcmax/(3600 * 24)\n            jmax &lt;- jmax/(3600 * 24)\n            gs &lt;- gs/(3600 * 24)\n            a_c &lt;- a_c/(3600 * 24)\n            a_j &lt;- a_j/(3600 * 24)\n            a_gross &lt;- a_gross/(3600 * 24)\n        }\n        return(tibble(vcmax = vcmax, jmax = jmax, gs = gs, ci = ci, \n            chi = ci/ca, a_c = a_c, a_j = a_j, a_gross = a_gross, \n            ci_c = ci_c, ci_j = ci_j, cost_transp = carbon_costs$cost_transp, \n            cost_vcmax = carbon_costs$cost_vcmax, cost_jmax = carbon_costs$cost_jmax, \n            carbon_costs = carbon_costs$carbon_costs, include_energy_balance = include_energy_balance, \n            tc_air = tc_air, tc_leaf = tc_leaf))\n    }\n    else {\n        return(carbon_costs$carbon_costs)\n    }\n}\n&lt;bytecode: 0x125bdb858&gt;\n\n\n\n\n\n\n\n\n\n\n\nget_carbon_costs()\n\n\n\n\n\n\n\nfunction (ns_star, gs, vpd_leaf, beta, vcmax, c_cost, jmax, a_gross, \n    cost_type) \n{\n    cost_options &lt;- c(\"relative_carbon_costs\")\n    if (!(cost_type %in% cost_options)) {\n        stop(\"get_carbon_costs: Requested cost type not implemented.\")\n    }\n    cost_transp &lt;- 1.6 * ns_star * gs * vpd_leaf\n    cost_vcmax &lt;- beta * vcmax\n    cost_jmax &lt;- c_cost * jmax\n    if (cost_type == \"relative_carbon_costs\") {\n        carbon_costs &lt;- (cost_transp + cost_vcmax + cost_jmax)/a_gross\n    }\n    out &lt;- list(cost_transp = cost_transp, cost_vcmax = cost_vcmax, \n        cost_jmax = cost_jmax, carbon_costs = carbon_costs)\n}\n&lt;bytecode: 0x124cac910&gt;\n\n\n\n\n\n\n\n\n\n\n\noptimize_traits_and_costs()\n\n\n\n\n\n\n\nfunction (tc_air, vpd_air, patm, co2, ppfd, kphio, include_energy_balance = FALSE, \n    vcmax_start = NA, jmax_start = NA, gs_start = NA, ...) \n{\n    ppfd &lt;- ppfd * 3600 * 24\n    vcmax_start &lt;- 20\n    jmax_start &lt;- 20\n    gs_start &lt;- 0.3\n    out_optim &lt;- optimr::optimr(par = c(vcmax_start, jmax_start, \n        gs_start), upper = c(vcmax_start * 1000, jmax_start * \n        1000, gs_start * 100), lower = c(vcmax_start/1000, jmax_start/1000, \n        gs_start/100), fn = calculate_traits_and_costs, method = \"L-BFGS-B\", \n        control = list(maxit = 1000), tc_air = tc_air, vpd_air = vpd_air, \n        patm = patm, co2 = co2, ppfd = ppfd, kphio = kphio, include_energy_balance = include_energy_balance, \n        maximize = TRUE, return_all = FALSE, ...)\n    optimized_par &lt;- calculate_traits_and_costs(par = out_optim$par, \n        tc_air = tc_air, vpd_air = vpd_air, patm = patm, co2 = co2, \n        ppfd = ppfd, kphio = kphio, include_energy_balance = include_energy_balance, \n        units_out = \"per-s\", return_all = TRUE, ...)\n    return(optimized_par)\n}\n&lt;bytecode: 0x14396a148&gt;\n\n\n\n\n\n\n\n\n3.2.2 Energy Balance\nBelow is a demonstration of the energy balance functions and a sensitivity analysis.\n\ndiff_tcleaf &lt;- \n  calculate_leaf_energy_balance(  \n    tc_leaf       = tc_leaf, \n    tc_air        = tc_air,\n    gs            = gs,\n    ppfd          = ppfd, \n    vpd_air       = vpd_air, \n    patm          = patm,\n    return_what   = c(\"balance\")\n  )\n\nleb_fluxes &lt;- \n  calculate_leaf_energy_balance(  \n    tc_leaf       = tc_leaf, \n    tc_air        = tc_air,\n    gs            = gs,\n    ppfd          = ppfd, \n    vpd_air       = vpd_air, \n    patm          = patm,\n    return_what   = c(\"fluxes\")\n  )\n\ncat(\"\\nThe squared difference between input tc_leaf and\",\n    \"\\nenergy-balance-closure tc_leaf is: \", diff_tcleaf)\n\n\nThe squared difference between input tc_leaf and \nenergy-balance-closure tc_leaf is:  6.507787\n\ncat(\"\\nThe energy balance variables at this state are: \")\n\n\nThe energy balance variables at this state are: \n\nknitr::kable(leb_fluxes)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nELEAFeb\nGradiation\nRsol\nRnetiso\nRlongup\nH\nlambdaET\ngw\nGbh\nH2\ntc_leaf2\n\n\n\n\n3.312554\n0.1949628\n218.8184\n11.49047\n454.922\n416.2046\n145.5992\n0.2252718\n2.845609\n-125.5096\n23.49221\n\n\n\n\n\n\ntc_leaf_eb &lt;- \n  optimize_leaf_energy_balance(\n   tc_air  = tc_air,\n   vpd_air = vpd_air,\n   gs      = gs,\n   ppfd    = ppfd,\n   patm    = patm,\n )\n\ncat(\"Given the environment and gs, tc_leaf is: \", tc_leaf_eb)\n\nGiven the environment and gs, tc_leaf is:  23.45996\n\n\n\n3.2.2.1 Relevant Functions\n\n\n\n\n\n\ncalculate_leaf_energy_balance()\n\n\n\n\n\n\n\nfunction (tc_leaf = 21.5, tc_air = 20, gs = 1.5e-06, ppfd = 0.0015, \n    vpd_air = 2000, patm = 101325, wind = 2, leaf_size = 0.02, \n    stomata_ratio = 1, leaf_abs = 0.5, return_what = c(\"balance\", \n        \"fluxes\")) \n{\n    return_what &lt;- match.arg(return_what)\n    gs &lt;- 1.6 * gs * patm\n    ppfd &lt;- ppfd * 10^6\n    Boltz &lt;- 5.67 * 10^-8\n    Emissivity &lt;- 0.95\n    LatEvap &lt;- 2.54\n    CPAIR &lt;- 1010\n    H2OLV0 &lt;- 2501000\n    H2OMW &lt;- 0.018\n    AIRMA &lt;- 0.029\n    AIRDENS &lt;- 1.204\n    UMOLPERJ &lt;- 4.57\n    DHEAT &lt;- 2.15e-05\n    AIRDENS &lt;- patm/(287.058 * celsius_to_kelvin(tc_air))\n    LHV &lt;- (H2OLV0 - 2365 * tc_air) * H2OMW\n    SLOPE &lt;- (esat(tc_air + 0.1) - esat(tc_air))/0.1\n    Gradiation &lt;- 4 * Boltz * celsius_to_kelvin(tc_air)^3 * Emissivity/(CPAIR * \n        AIRMA)\n    CMOLAR &lt;- patm/(8.314 * celsius_to_kelvin(tc_air))\n    Gbhforced &lt;- 0.003 * sqrt(wind/leaf_size) * CMOLAR\n    GRASHOF &lt;- 1.6e+08 * abs(tc_leaf - tc_air) * (leaf_size^3)\n    Gbhfree &lt;- 0.5 * DHEAT * (GRASHOF^0.25)/leaf_size * CMOLAR\n    Gbh &lt;- 2 * (Gbhfree + Gbhforced)\n    Gbhr &lt;- Gbh + 2 * Gradiation\n    Gbw &lt;- stomata_ratio * 1.075 * Gbh\n    gw &lt;- gs * Gbw/(gs + Gbw)\n    Rlongup &lt;- Emissivity * Boltz * celsius_to_kelvin(tc_leaf)^4\n    Rsol &lt;- 2 * ppfd/UMOLPERJ\n    Rnet &lt;- leaf_abs * Rsol - Rlongup\n    ea &lt;- esat(tc_air, patm) - vpd_air\n    ema &lt;- 0.642 * (ea/celsius_to_kelvin(tc_air))^(1/7)\n    if (is.na(ema)) {\n        stop(\"calculate_leaf_energy_balance: `ema` is NA, likely due to unrealistic combination of given vpd and air temperature (too high vpd for that air temperature).\")\n    }\n    Rnetiso &lt;- leaf_abs * Rsol - (1 - ema) * Boltz * celsius_to_kelvin(tc_air)^4\n    GAMMA &lt;- CPAIR * AIRMA * patm/LHV\n    ET &lt;- (1/LHV) * (SLOPE * Rnetiso + vpd_air * Gbh * CPAIR * \n        AIRMA)/(SLOPE + GAMMA * Gbhr/gw)\n    lambdaET &lt;- LHV * ET\n    Y &lt;- 1/(1 + Gradiation/Gbh)\n    H2 &lt;- Y * (Rnetiso - lambdaET)\n    H &lt;- -CPAIR * AIRDENS * (Gbh/CMOLAR) * (tc_air - tc_leaf)\n    tc_leaf2 &lt;- tc_air + H2/(CPAIR * AIRDENS * (Gbh/CMOLAR))\n    EnergyBal &lt;- (tc_leaf - tc_leaf2)\n    if (return_what == \"balance\") {\n        return(EnergyBal)\n    }\n    if (return_what == \"fluxes\") {\n        l &lt;- data.frame(ELEAFeb = 1000 * ET, Gradiation = Gradiation, \n            Rsol = Rsol, Rnetiso = Rnetiso, Rlongup = Rlongup, \n            H = H, lambdaET = lambdaET, gw = gw, Gbh = Gbh, H2 = H2, \n            tc_leaf2 = tc_leaf2)\n        return(l)\n    }\n}\n&lt;bytecode: 0x125748470&gt;\n\n\n\n\n\n\n\n\n\n\n\noptimize_leaf_energy_balance()\n\n\n\n\n\n\n\nfunction (tc_air, vpd_air, gs, ppfd, patm, ...) \n{\n    sol_optimize &lt;- uniroot(f = calculate_leaf_energy_balance, \n        interval = c(max(tc_air - 15, 1), tc_air + 15), tc_air = tc_air, \n        vpd_air = vpd_air, gs = gs, ppfd = ppfd, patm = patm, \n        return_what = \"balance\", ...)\n    tc_leaf &lt;- sol_optimize$root\n    return(tc_leaf)\n}\n\n\n\n\n\n\n\n3.2.2.2 Sensitivity Analysis\n\nrun_fun &lt;- function(df, var) {\n  \n  for (i in 1:nrow(df)) {\n    df$tc_leaf[i] &lt;- \n      optimize_leaf_energy_balance(\n        tc_air  = df$tc_air[i],\n        vpd_air = df$vpd_air[i],\n        gs      = df$gs[i],\n        ppfd    = df$ppfd[i],\n        patm    = df$patm[i],\n        wind    = df$wind[i],\n        leaf_size = df$leaf_size[i],\n        stomata_ratio = df$stomata_ratio[i],\n        leaf_abs = df$leaf_abs[i]\n        )\n    \n      df$tc_diff[i] = df$tc_leaf[i] - df$tc_air[i]\n  }\n  \n  df_out &lt;- df |&gt; select(c(!!var, \"tc_leaf\", \"tc_diff\")) |&gt; pivot_longer(cols = !!var)\n  \n  return(df_out)\n}\n\n\n\nCode\n# Create empty df for plotting\ndf_abio &lt;- tibble()\ndf_bio  &lt;- tibble()\n\n# Create base df for sensitivity analysis\nn_steps &lt;- 20\ndf_base &lt;- tibble(.rows = n_steps)\ndf_base$tc_air    &lt;- rep(tc_air , n_steps)\ndf_base$vpd_air   &lt;- rep(vpd_air, n_steps)\ndf_base$gs        &lt;- rep(gs     , n_steps)\ndf_base$co2       &lt;- rep(co2     , n_steps)\ndf_base$ppfd      &lt;- rep(ppfd   , n_steps)\ndf_base$patm      &lt;- rep(patm   , n_steps)\ndf_base$wind      &lt;- rep(wind, n_steps)\ndf_base$leaf_size &lt;- rep(leaf_size, n_steps)\ndf_base$leaf_abs  &lt;- rep(leaf_abs, n_steps)\ndf_base$tc_leaf   &lt;- rep(NA, n_steps)\ndf_base$tc_diff   &lt;- rep(NA, n_steps)\ndf_base$stomata_ratio   &lt;- rep(1, stomata_ratio)\ndf_base$kphio     &lt;- rep(kphio, stomata_ratio)\n\n\n\n\nCode\n### ABIOTIC VARIABLES\n## Air temperature and VPD\ndf_tmp &lt;- df_base\ndf_tmp$tc_air  &lt;- seq(1, 50, length.out = n_steps)\n\n# Account for changes in vpd when temperature changes:\ndf_tmp$vpd_air &lt;- \n  air_vpd_to_leaf_vpd(\n    vpd_air = vpd_air,\n    tc_air = tc_air,\n    tc_leaf = df_tmp$tc_air)\n\ndf_tmp &lt;- run_fun(df_tmp, \"tc_air\")\ndf_abio &lt;- rbind(df_abio, df_tmp)\n\n# PPFD\ndf_tmp &lt;- df_base\ndf_tmp$ppfd  &lt;- seq(ppfd/10, ppfd*10, length.out = n_steps)\n\ndf_tmp &lt;- run_fun(df_tmp, \"ppfd\")\ndf_abio &lt;- rbind(df_abio, df_tmp)\n\n# Atmospheric pressure\ndf_tmp &lt;- df_base\ndf_tmp$patm  &lt;- seq(patm/10, patm*10, length.out = n_steps)\n\ndf_tmp &lt;- run_fun(df_tmp, \"patm\")\ndf_abio &lt;- rbind(df_abio, df_tmp)\n\n# Wind\ndf_tmp &lt;- df_base\ndf_tmp$wind  &lt;- seq(wind/10, wind*10, length.out = n_steps)\n\ndf_tmp &lt;- run_fun(df_tmp, \"wind\")\ndf_abio &lt;- rbind(df_abio, df_tmp)\n\n### BIOTIC VARIABLES\n# Stomatal Conductance\ndf_tmp &lt;- df_base\ndf_tmp$gs  &lt;- seq(gs/10, gs*10, length.out = n_steps)\n\ndf_tmp &lt;- run_fun(df_tmp, \"gs\")\ndf_bio &lt;- rbind(df_bio, df_tmp)\n\n# Leaf Size\ndf_tmp &lt;- df_base\ndf_tmp$leaf_size  &lt;- seq(leaf_size/10, leaf_size*10, length.out = n_steps)\n\ndf_tmp &lt;- run_fun(df_tmp, \"leaf_size\")\ndf_bio &lt;- rbind(df_bio, df_tmp)\n\n# Leaf absorptance\ndf_tmp &lt;- df_base\ndf_tmp$leaf_abs  &lt;- seq(leaf_abs/10, leaf_abs*10, length.out = n_steps)\n\ndf_tmp &lt;- run_fun(df_tmp, \"leaf_abs\")\ndf_bio &lt;- rbind(df_bio, df_tmp)\n\n# Stomatal Ratio\ndf_tmp &lt;- df_base |&gt; slice(1:2)\ndf_tmp$stomata_ratio  &lt;- c(1, 2)\n\ndf_tmp &lt;- run_fun(df_tmp, \"stomata_ratio\")\ndf_bio &lt;- rbind(df_bio, df_tmp)\n\n\n\n\nCode\ndf_abio$name &lt;- as.factor(df_abio$name)\ndf_bio$name &lt;- as.factor(df_bio$name)\n\ndf_abio |&gt; \n  ggplot() +\n  aes(x = value,\n      y = tc_leaf) +\n  geom_line() +\n  geom_point() +\n  facet_wrap(~name, \n             scales = \"free_x\") +\n  ylim(0, 50) + \n  labs(title = \"Sensitivity of tc_leaf to abiotic drivers.\",\n       y = \"T_leaf\",\n       x = \"\") +\n  theme_linedraw()\n\n\n\n\n\n\n\n\n\nCode\ndf_bio |&gt; \n  ggplot() +\n  aes(x = value,\n      y = tc_leaf) +\n  geom_line() +\n  geom_point() +\n  facet_wrap(~name, \n             scales = \"free_x\") +\n  ylim(0, 50) + \n  labs(title = \"Sensitivity of tc_leaf to biotic drivers.\",\n       y = \"T_leaf\",\n       x = \"\") +\n  theme_linedraw()\n\n\n\n\n\n\n\n\n\n\ndf_abio |&gt; \n  ggplot() +\n  aes(x = value,\n      y = tc_diff) +\n  geom_line() +\n  geom_point() +\n  facet_wrap(~name, \n             scales = \"free_x\") +\n  ylim(-7.5, 7.5) +\n  labs(title = \"Sensitivity of delta T to abiotic drivers\",\n       subtitle = \"Below dotted line means the leaf is cooler\",\n       y = \"T_leaf - T_air\",\n       x = \"\") +\n  geom_hline(yintercept = 0, lty = \"dotted\") +\n  theme_linedraw()\n\n\n\n\n\n\n\ndf_bio |&gt; \n  ggplot() +\n  aes(x = value,\n      y = tc_diff) +\n  geom_line() +\n  geom_point() +\n  facet_wrap(~name, \n             scales = \"free_x\") +\n  ylim(-7.5, 7.5) +\n  geom_hline(yintercept = 0, lty = \"dotted\") +\n  labs(title = \"Sensitivity of delta T to biotic drivers\",\n       subtitle = \"Below dotted line means the leaf is cooler\",\n       y = \"T_leaf - T_air\",\n       x = \"\") +\n  theme_linedraw()\n\n\n\n\n\n\n\n\n\n\n\n3.2.3 Coupled Model\n\noptimize_traits_and_costs(\n  tc_air  = tc_air,\n  vpd_air = vpd_air,\n  patm    = patm,\n  co2     = co2,\n  ppfd    = ppfd,\n  kphio   = kphio,\n  include_energy_balance = TRUE\n) |&gt; knitr::kable()\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nvcmax\njmax\ngs\nci\nchi\na_c\na_j\na_gross\nci_c\nci_j\ncost_transp\ncost_vcmax\ncost_jmax\ncarbon_costs\ninclude_energy_balance\ntc_air\ntc_leaf\n\n\n\n\n4.54e-05\n0.00036\n0.0002014\n40.42388\n0.9973817\n2.14e-05\n2.14e-05\n2.14e-05\n40.42388\n40.42386\n29.50253\n572.0753\n3.203276\n327.5584\nTRUE\n25\n18.04351\n\n\n\n\n\n\n3.2.3.1 Sensitivity Analysis\n\n## Air temperature and VPD\ndf_tmp &lt;- df_base\ndf_tmp$tc_air  &lt;- seq(1, 50, length.out = n_steps)\n\n# Account for changes in vpd when temperature changes:\ndf_tmp$vpd_air &lt;- \n  air_vpd_to_leaf_vpd(\n    vpd_air = vpd_air,\n    tc_air = tc_air,\n    tc_leaf = df_tmp$tc_air)\n\n# With and Without EB\ndf_with_eb &lt;- df_tmp\ndf_wout_eb &lt;- df_tmp\n\n# Run loop\nfor (i in 1:nrow(df_tmp)) {\n  \n  # cat(\"\\n Working on\", i, \"/\", nrow(df_tmp))\n  \n  df_with_eb$data[i] &lt;- \n    optimize_traits_and_costs(\n      tc_air  = df_with_eb$tc_air[i],\n      vpd_air = df_with_eb$vpd_air[i],\n      ppfd    = df_with_eb$ppfd[i],\n      patm    = df_with_eb$patm[i],\n      co2     = df_with_eb$co2[i],\n      kphio   = df_with_eb$kphio[i],\n      include_energy_balance = FALSE\n      ) |&gt; list()\n  \n  df_wout_eb$data[i] &lt;- \n    optimize_traits_and_costs(\n      tc_air  = df_wout_eb$tc_air[i],\n      vpd_air = df_wout_eb$vpd_air[i],\n      ppfd    = df_wout_eb$ppfd[i],\n      patm    = df_wout_eb$patm[i],\n      co2     = df_wout_eb$co2[i],\n      kphio   = df_wout_eb$kphio[i],\n      include_energy_balance = TRUE\n      ) |&gt; list()\n}\n\n# Finish up dataframes\n\nvars_tc &lt;- c(\"tc_air\", \"tc_leaf\", \"tc_diff\")\nvars_pm &lt;- c(\"vcmax\", \"jmax\", \"gs\", \"chi\")\n\ndf_with_eb &lt;- \n  df_with_eb |&gt; \n  select(data) |&gt; \n  unnest(data) |&gt;\n  select(any_of(c(vars_tc, vars_pm))) |&gt; \n  mutate(tc_diff = tc_leaf - tc_air) |&gt; \n  pivot_longer(cols = !any_of(vars_tc)) |&gt; \n  mutate(name = as.factor(name))\n\ndf_wout_eb &lt;- \n  df_wout_eb |&gt; \n  select(data) |&gt; \n  unnest(data) |&gt;\n  select(any_of(c(vars_tc, vars_pm))) |&gt; \n  mutate(tc_diff = tc_leaf - tc_air) |&gt; \n  pivot_longer(cols = !any_of(vars_tc)) |&gt; \n  mutate(name = as.factor(name))\n\ndf_fin &lt;- \n  rbind(\n    df_wout_eb |&gt; mutate(energy_balance = FALSE),\n    df_with_eb |&gt; mutate(energy_balance = TRUE)\n    )\n\ndf_fin |&gt; \n  ggplot() +\n  aes(y = value,\n      x = tc_air,\n      color = energy_balance) +\n  geom_line() +\n  geom_point() +\n  facet_wrap(~name, \n             scales = \"free_y\") +\n  labs(title = \"Sensitivity of traits to tc_air\",\n       x = \"T_air\",\n       y = \"Trait Value\") +\n  geom_hline(yintercept = 0, lty = \"dotted\") +\n  theme_linedraw() \n\n\n\n\n\n\n\ndf_fin |&gt; \n  select(tc_air, tc_leaf, energy_balance) |&gt; \n  distinct() |&gt; \n  ggplot() +\n  aes(y = tc_leaf,\n      x = tc_air,\n      color = energy_balance) +\n  geom_line() +\n  geom_point() +\n  labs(title = \"Sensitivity of traits to tc_air\",\n       x = \"T_air\",\n       y = \"T_leaf\") +\n  geom_abline(intercept = 0, slope = 1, lty = \"dotted\") +\n  theme_linedraw()"
  },
  {
    "objectID": "05-test_case.html#leaf-traits",
    "href": "05-test_case.html#leaf-traits",
    "title": "5  Test Cases",
    "section": "5.1 Leaf traits",
    "text": "5.1 Leaf traits\nAs a test-case to see whether the numerical P-Model and its coupling with the energy balance model leads to reliable predictions, we are going to predict \\(V_{cmax}\\). Alter"
  },
  {
    "objectID": "05-test_case.html#land-surface-temperature",
    "href": "05-test_case.html#land-surface-temperature",
    "title": "5  Test Cases",
    "section": "5.2 Land surface temperature",
    "text": "5.2 Land surface temperature"
  },
  {
    "objectID": "05-test_case.html#water-isotopes",
    "href": "05-test_case.html#water-isotopes",
    "title": "5  Test Cases",
    "section": "5.3 Water Isotopes",
    "text": "5.3 Water Isotopes"
  },
  {
    "objectID": "98-next-steps.html",
    "href": "98-next-steps.html",
    "title": "6  Next Steps",
    "section": "",
    "text": "Use different formulations for the cost function (relative costs, total costs)\nGetting different results when using different starting values for the optimization of traits\nImplement another optimization algorithm and compare performances\nTry to implement the cost for Jmax as well\n\nNote: This could become tricky because of it having too little\n\nSketch an algorithm to account for an instantaneous energy balance model\nPotential Test Casta\n\nLin et al data"
  },
  {
    "objectID": "99-variables.html",
    "href": "99-variables.html",
    "title": "Variables",
    "section": "",
    "text": "Overview of variables used in this tutorial.\n\n\n\n\n\n\n\n\nSymbol\nVariable\nUnit\nDescription\n\n\n\n\n\\(V_{cmax}\\)\nvcmax\n\\(\\mu\\)mol/CO\\(_2\\)/s\nMaximum carboxylation rate of rubisco\n\n\n\\(J_{max}\\)\njmax\n\n\n\n\n\\(g_s\\)\ngs\n\nStomatal conductance\n\n\n\\(c_i\\)\nci\n-\nLeaf-internal CO\\(_2\\) concentration\n\n\n\\(A_c\\)\nac\n\nCarboxylation-limited photosynthesis\n\n\n\\(A_j\\)\naj\n\nRuBP-limited photosynthesis\n\n\n\\(A_{gross}\\)\nagross\n\nGross photosynthesis\n\n\n\\(D\\)\nvpd\nPa\nVapor pressure deficit"
  },
  {
    "objectID": "references.html",
    "href": "references.html",
    "title": "References",
    "section": "",
    "text": "Berry, J., & Bjorkman, O. (1980). Photosynthetic Response and\nAdaptation to Temperature in Higher Plants. Annual Review of Plant\nPhysiology, 31(1), 491–543. https://doi.org/10.1146/annurev.pp.31.060180.002423\n\n\nMaire, V., Martre, P., Kattge, J., Gastal, F., Esser, G., Fontaine, S.,\n& Soussana, J.-F. (2012). The Coordination of Leaf Photosynthesis\nLinks C and N Fluxes in C3 Plant Species. PLoS ONE,\n7(6), e38345. https://doi.org/10.1371/journal.pone.0038345\n\n\nPeng, Y., Bloomfield, K. J., Cernusak, L. A., Domingues, T. F., &\nColin Prentice, I. (2021). Global climate and nutrient controls of\nphotosynthetic capacity. Communications Biology, 4(1),\n462. https://doi.org/10.1038/s42003-021-01985-7\n\n\nPrentice, I. C., Dong, N., Gleason, M. S., Maire, V., & Wright, J.\nI. (2014). Balancing the costs of carbon gain and water transport:\nTesting a new theoretical framework for plant functional ecology.\nEcology Letters, 17(1), 8291. https://doi.org/gf9w4m\n\n\nRogers, A. (2014). The use and misuse of Vcmax in Earth System Models.\nPhotosynthesis Research, 119(1-2), 15–29. https://doi.org/10.1007/s11120-013-9818-1\n\n\nStocker, B. D., Wang, H., Smith, N. G., Harrison, S. P., Keenan, T. F.,\nSandoval, D., Davis, T., & Prentice, I. C. (2020). P-model v1.0: an\noptimality-based light use efficiency model for simulating ecosystem\ngross primary production. Geoscientific Model Development,\n13(3), 1545–1581. https://doi.org/10.5194/gmd-13-1545-2020\n\n\nStocker, B., & Hufkens, K. (2021). Rpmodel v1.2.0: R package\nimplementing the p-model. Zenodo. https://doi.org/10.5281/ZENODO.3359706"
  }
]